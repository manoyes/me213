(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    117289,       2911]
NotebookOptionsPosition[    112538,       2759]
NotebookOutlinePosition[    113061,       2777]
CellTagsIndexPosition[    113018,       2774]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[{
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"SubValues", "[", "Derivative", "]"}], "=", 
   RowBox[{"{", "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6060608346889343`*^9, 3.6060608393891706`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Problem", " ", "4"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Energies", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], " ", "M", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"y", "'"}], "[", "t", "]"}], "^", "2"}]}], " ", "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], " ", "m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"y1", "'"}], "[", "t", "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"z1", "'"}], "[", "t", "]"}], "^", "2"}]}], ")"}]}]}]}], 
    " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V", "=", 
     RowBox[{"m", " ", "g", " ", 
      RowBox[{"z1", "[", "t", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Geometric", " ", "contrainsts"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"y1", "[", "t_", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"y", "[", "t", "]"}], "+", " ", 
      RowBox[{"l", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"z1", "[", "t_", "]"}], " ", "=", " ", 
     RowBox[{"l", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"parameters", " ", "=", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"M", " ", "\[Rule]", "100"}], ",", " ", 
       RowBox[{"m", "\[Rule]", "50"}], ",", " ", 
       RowBox[{"l", "\[Rule]", "2"}], ",", 
       RowBox[{"g", "\[Rule]", "9.81"}]}], "}"}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"T", "=", 
    RowBox[{"Collect", "[", 
     RowBox[{"T", ",", "\[Theta]", ",", "Simplify"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"V", "=", 
    RowBox[{"Simplify", "[", "V", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", " ", "=", " ", 
     RowBox[{"T", "-", "V"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.60480209441348*^9, 3.60480224637568*^9}, {
   3.6048053539504223`*^9, 3.604805414124034*^9}, {3.604847511925222*^9, 
   3.604847524509181*^9}, {3.604847870081482*^9, 3.6048478827970133`*^9}, {
   3.6048562737754707`*^9, 3.604856295529134*^9}, {3.604920144599045*^9, 
   3.604920155299158*^9}, {3.605975405992836*^9, 3.605975443551852*^9}, {
   3.6059754882271137`*^9, 3.605975496580023*^9}, {3.605975533651566*^9, 
   3.605975543938223*^9}, {3.6059853102508297`*^9, 3.605985336304511*^9}, {
   3.605985396064217*^9, 3.605985419855258*^9}, 3.606083266125321*^9, 
   3.606083309574587*^9, 3.606083419907196*^9, 3.606083466656435*^9, {
   3.606135037539248*^9, 3.606135037599989*^9}, {3.60633281897444*^9, 
   3.6063328513105392`*^9}, {3.6063328848706913`*^9, 3.606332891131785*^9}, {
   3.606333027289425*^9, 3.606333066134709*^9}, {3.606333630742352*^9, 
   3.606333644731192*^9}, {3.6063346828827477`*^9, 3.606334714481208*^9}, {
   3.606334777712214*^9, 3.606334777823902*^9}, {3.606335392266704*^9, 
   3.606335397629369*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["l", "2"], " ", "m", " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[Theta]", "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "2"]}], "+", 
     RowBox[{"2", " ", "l", " ", "m", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]",
        MultilineFunction->None], "(", "t", ")"}], " ", 
      RowBox[{"cos", "(", 
       RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["y", "\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"m", "+", "M"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["y", "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "2"]}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.605975497319916*^9, 3.6059778462545967`*^9, 3.6059847479568043`*^9, {
   3.6059853846412163`*^9, 3.60598542070373*^9}, 3.606056176777391*^9, 
   3.606060842718752*^9, 3.606061137983459*^9, {3.6060623757078*^9, 
   3.606062397035062*^9}, 3.6060647653155117`*^9, 3.606065236464774*^9, {
   3.60606527514742*^9, 3.606065301376217*^9}, 3.606066441958508*^9, 
   3.606082602374206*^9, 3.6060826344924097`*^9, 3.60608267330742*^9, 
   3.606083149763795*^9, {3.606083208371565*^9, 3.6060832240830507`*^9}, {
   3.6060832706893587`*^9, 3.606083310608101*^9}, {3.606083411269063*^9, 
   3.606083424163637*^9}, {3.606083467976819*^9, 3.6060835260023623`*^9}, 
   3.606083686270978*^9, 3.606083833401062*^9, {3.6061329140727243`*^9, 
   3.60613295694947*^9}, 3.606132999059803*^9, 3.606134987862258*^9, 
   3.606332858660829*^9, {3.606332892550878*^9, 3.6063329014440737`*^9}, {
   3.606333055233117*^9, 3.606333066415049*^9}, 3.606333649132063*^9, 
   3.6063344253842278`*^9, {3.606334663388479*^9, 3.606334715217478*^9}, 
   3.606334958403097*^9, 3.606335116747897*^9, 3.60633540206213*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"g", " ", "l", " ", "m", " ", 
   RowBox[{"cos", "(", 
    RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], TraditionalForm]], "Output",\

 CellChangeTimes->{
  3.605975497319916*^9, 3.6059778462545967`*^9, 3.6059847479568043`*^9, {
   3.6059853846412163`*^9, 3.60598542070373*^9}, 3.606056176777391*^9, 
   3.606060842718752*^9, 3.606061137983459*^9, {3.6060623757078*^9, 
   3.606062397035062*^9}, 3.6060647653155117`*^9, 3.606065236464774*^9, {
   3.60606527514742*^9, 3.606065301376217*^9}, 3.606066441958508*^9, 
   3.606082602374206*^9, 3.6060826344924097`*^9, 3.60608267330742*^9, 
   3.606083149763795*^9, {3.606083208371565*^9, 3.6060832240830507`*^9}, {
   3.6060832706893587`*^9, 3.606083310608101*^9}, {3.606083411269063*^9, 
   3.606083424163637*^9}, {3.606083467976819*^9, 3.6060835260023623`*^9}, 
   3.606083686270978*^9, 3.606083833401062*^9, {3.6061329140727243`*^9, 
   3.60613295694947*^9}, 3.606132999059803*^9, 3.606134987862258*^9, 
   3.606332858660829*^9, {3.606332892550878*^9, 3.6063329014440737`*^9}, {
   3.606333055233117*^9, 3.606333066415049*^9}, 3.606333649132063*^9, 
   3.6063344253842278`*^9, {3.606334663388479*^9, 3.606334715217478*^9}, 
   3.606334958403097*^9, 3.606335116747897*^9, 3.606335402066163*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"E", "-", 
    RowBox[{"L", " ", "equations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"eqn1", "=", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"L", ",", 
           RowBox[{
            RowBox[{"y", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], "]"}], 
       "-", 
       RowBox[{"D", "[", 
        RowBox[{"L", ",", 
         RowBox[{"y", "[", "t", "]"}]}], "]"}]}], "]"}], " ", "-", " ", 
     "f"}]}], "\[IndentingNewLine]", 
   RowBox[{"eqn2", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", 
          RowBox[{
           RowBox[{"\[Theta]", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
       "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"L", ",", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "]"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"ytt", " ", "=", " ", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"eqn1", "\[Equal]", "0"}], ",", " ", 
       RowBox[{
        RowBox[{"y", "''"}], "[", "t", "]"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"\[Theta]tt", "=", 
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"eqn2", "\[Equal]", "0"}], ",", 
       RowBox[{
        RowBox[{"\[Theta]", "''"}], "[", "t", "]"}]}], "]"}], "[", 
     RowBox[{"[", 
      RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.604802270230612*^9, 3.604802297448539*^9}, {
  3.60597545028353*^9, 3.6059754505710278`*^9}, {3.605975549158205*^9, 
  3.6059755528168707`*^9}, {3.60598538035201*^9, 3.605985380694002*^9}, {
  3.605985434383439*^9, 3.605985436589528*^9}, {3.606062336805756*^9, 
  3.606062392300824*^9}, {3.606332917955432*^9, 3.6063329399922533`*^9}, {
  3.606333097904853*^9, 3.6063331005414553`*^9}, {3.606334606940711*^9, 
  3.6063346519656267`*^9}, {3.606334727340597*^9, 3.6063347295266867`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", "f"}], "+", 
   RowBox[{"l", " ", "m", " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}], " ", 
    RowBox[{"cos", "(", 
     RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "-", 
   RowBox[{"l", " ", "m", " ", 
    SuperscriptBox[
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "2"], " ", 
    RowBox[{"sin", "(", 
     RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", "+", "M"}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["y", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.6048022981883497`*^9, 3.604805429701419*^9, 3.6048478954205*^9, 
   3.604848380604824*^9, 3.604852826941059*^9, 3.6048549557113047`*^9, 
   3.60485612495221*^9, 3.60487236046386*^9, 3.605975452142623*^9, 
   3.6059755000495853`*^9, 3.6059755531859913`*^9, 3.605975596167368*^9, 
   3.605976203666453*^9, 3.605977848170267*^9, 3.605984748066732*^9, 
   3.605985382119973*^9, {3.605985441405431*^9, 3.605985460702155*^9}, 
   3.606056176829975*^9, 3.60606084276919*^9, 3.606061141004527*^9, {
   3.606062369858897*^9, 3.606062397088902*^9}, 3.606064765369216*^9, 
   3.606065236517949*^9, {3.606065275262528*^9, 3.606065301446177*^9}, 
   3.606066442045537*^9, 3.6060826024412947`*^9, 3.606082634583452*^9, 
   3.606082673400235*^9, 3.60608314982831*^9, {3.606083208446467*^9, 
   3.60608322415342*^9}, {3.60608327074959*^9, 3.6060832907768087`*^9}, {
   3.606083411340273*^9, 3.606083424249543*^9}, {3.606083473127097*^9, 
   3.606083526072352*^9}, 3.606083686336164*^9, 3.606083833478853*^9, {
   3.6061329141410503`*^9, 3.6061329570182734`*^9}, 3.6061329991098013`*^9, 
   3.6061349879927073`*^9, 3.606332864092003*^9, {3.606332906982832*^9, 
   3.60633294056675*^9}, 3.6063330704946012`*^9, 3.606333106525378*^9, {
   3.606333651760697*^9, 3.606333655284807*^9}, 3.606334425475154*^9, {
   3.606334633809236*^9, 3.606334665138283*^9}, 3.6063346972662897`*^9, 
   3.606334729980167*^9, 3.606334958491106*^9, 3.606335116824531*^9, 
   3.606335402158495*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"l", " ", "m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"g", " ", 
       RowBox[{"sin", "(", 
        RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], "+", 
     RowBox[{"l", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}], "+", 
     RowBox[{
      RowBox[{"cos", "(", 
       RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
      RowBox[{
       SuperscriptBox["y", "\[Prime]\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.6048022981883497`*^9, 3.604805429701419*^9, 3.6048478954205*^9, 
   3.604848380604824*^9, 3.604852826941059*^9, 3.6048549557113047`*^9, 
   3.60485612495221*^9, 3.60487236046386*^9, 3.605975452142623*^9, 
   3.6059755000495853`*^9, 3.6059755531859913`*^9, 3.605975596167368*^9, 
   3.605976203666453*^9, 3.605977848170267*^9, 3.605984748066732*^9, 
   3.605985382119973*^9, {3.605985441405431*^9, 3.605985460702155*^9}, 
   3.606056176829975*^9, 3.60606084276919*^9, 3.606061141004527*^9, {
   3.606062369858897*^9, 3.606062397088902*^9}, 3.606064765369216*^9, 
   3.606065236517949*^9, {3.606065275262528*^9, 3.606065301446177*^9}, 
   3.606066442045537*^9, 3.6060826024412947`*^9, 3.606082634583452*^9, 
   3.606082673400235*^9, 3.60608314982831*^9, {3.606083208446467*^9, 
   3.60608322415342*^9}, {3.60608327074959*^9, 3.6060832907768087`*^9}, {
   3.606083411340273*^9, 3.606083424249543*^9}, {3.606083473127097*^9, 
   3.606083526072352*^9}, 3.606083686336164*^9, 3.606083833478853*^9, {
   3.6061329141410503`*^9, 3.6061329570182734`*^9}, 3.6061329991098013`*^9, 
   3.6061349879927073`*^9, 3.606332864092003*^9, {3.606332906982832*^9, 
   3.60633294056675*^9}, 3.6063330704946012`*^9, 3.606333106525378*^9, {
   3.606333651760697*^9, 3.606333655284807*^9}, 3.606334425475154*^9, {
   3.606334633809236*^9, 3.606334665138283*^9}, 3.6063346972662897`*^9, 
   3.606334729980167*^9, 3.606334958491106*^9, 3.606335116824531*^9, 
   3.6063354022152233`*^9}],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"f", "-", 
    RowBox[{"l", " ", "m", " ", 
     RowBox[{
      SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], " ", 
     RowBox[{"cos", "(", 
      RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "+", 
    RowBox[{"l", " ", "m", " ", 
     SuperscriptBox[
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]",
        MultilineFunction->None], "(", "t", ")"}], "2"], " ", 
     RowBox[{"sin", "(", 
      RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}]}], 
   RowBox[{"m", "+", "M"}]], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.6048022981883497`*^9, 3.604805429701419*^9, 3.6048478954205*^9, 
   3.604848380604824*^9, 3.604852826941059*^9, 3.6048549557113047`*^9, 
   3.60485612495221*^9, 3.60487236046386*^9, 3.605975452142623*^9, 
   3.6059755000495853`*^9, 3.6059755531859913`*^9, 3.605975596167368*^9, 
   3.605976203666453*^9, 3.605977848170267*^9, 3.605984748066732*^9, 
   3.605985382119973*^9, {3.605985441405431*^9, 3.605985460702155*^9}, 
   3.606056176829975*^9, 3.60606084276919*^9, 3.606061141004527*^9, {
   3.606062369858897*^9, 3.606062397088902*^9}, 3.606064765369216*^9, 
   3.606065236517949*^9, {3.606065275262528*^9, 3.606065301446177*^9}, 
   3.606066442045537*^9, 3.6060826024412947`*^9, 3.606082634583452*^9, 
   3.606082673400235*^9, 3.60608314982831*^9, {3.606083208446467*^9, 
   3.60608322415342*^9}, {3.60608327074959*^9, 3.6060832907768087`*^9}, {
   3.606083411340273*^9, 3.606083424249543*^9}, {3.606083473127097*^9, 
   3.606083526072352*^9}, 3.606083686336164*^9, 3.606083833478853*^9, {
   3.6061329141410503`*^9, 3.6061329570182734`*^9}, 3.6061329991098013`*^9, 
   3.6061349879927073`*^9, 3.606332864092003*^9, {3.606332906982832*^9, 
   3.60633294056675*^9}, 3.6063330704946012`*^9, 3.606333106525378*^9, {
   3.606333651760697*^9, 3.606333655284807*^9}, 3.606334425475154*^9, {
   3.606334633809236*^9, 3.606334665138283*^9}, 3.6063346972662897`*^9, 
   3.606334729980167*^9, 3.606334958491106*^9, 3.606335116824531*^9, 
   3.60633540226478*^9}],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{
    RowBox[{"g", " ", 
     RowBox[{"sin", "(", 
      RowBox[{"\[Theta]", "(", "t", ")"}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"cos", "(", 
      RowBox[{"\[Theta]", "(", "t", ")"}], ")"}], " ", 
     RowBox[{
      SuperscriptBox["y", "\[Prime]\[Prime]",
       MultilineFunction->None], "(", "t", ")"}]}]}], "l"], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.6048022981883497`*^9, 3.604805429701419*^9, 3.6048478954205*^9, 
   3.604848380604824*^9, 3.604852826941059*^9, 3.6048549557113047`*^9, 
   3.60485612495221*^9, 3.60487236046386*^9, 3.605975452142623*^9, 
   3.6059755000495853`*^9, 3.6059755531859913`*^9, 3.605975596167368*^9, 
   3.605976203666453*^9, 3.605977848170267*^9, 3.605984748066732*^9, 
   3.605985382119973*^9, {3.605985441405431*^9, 3.605985460702155*^9}, 
   3.606056176829975*^9, 3.60606084276919*^9, 3.606061141004527*^9, {
   3.606062369858897*^9, 3.606062397088902*^9}, 3.606064765369216*^9, 
   3.606065236517949*^9, {3.606065275262528*^9, 3.606065301446177*^9}, 
   3.606066442045537*^9, 3.6060826024412947`*^9, 3.606082634583452*^9, 
   3.606082673400235*^9, 3.60608314982831*^9, {3.606083208446467*^9, 
   3.60608322415342*^9}, {3.60608327074959*^9, 3.6060832907768087`*^9}, {
   3.606083411340273*^9, 3.606083424249543*^9}, {3.606083473127097*^9, 
   3.606083526072352*^9}, 3.606083686336164*^9, 3.606083833478853*^9, {
   3.6061329141410503`*^9, 3.6061329570182734`*^9}, 3.6061329991098013`*^9, 
   3.6061349879927073`*^9, 3.606332864092003*^9, {3.606332906982832*^9, 
   3.60633294056675*^9}, 3.6063330704946012`*^9, 3.606333106525378*^9, {
   3.606333651760697*^9, 3.606333655284807*^9}, 3.606334425475154*^9, {
   3.606334633809236*^9, 3.606334665138283*^9}, 3.6063346972662897`*^9, 
   3.606334729980167*^9, 3.606334958491106*^9, 3.606335116824531*^9, 
   3.606335402268228*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"leqn1", " ", "=", " ", 
  RowBox[{"eqn1", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "^", "2"}], "\[Rule]", 
      "0"}], ",", " ", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "\[Rule]", "1"}]}], 
    "}"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"leqn2", " ", "=", " ", 
  RowBox[{"eqn2", " ", "/.", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "\[Rule]", 
      RowBox[{"\[Theta]", "[", "t", "]"}]}], ",", " ", 
     RowBox[{
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]", "[", "t", "]"}], "]"}], "\[Rule]", "1"}]}], 
    "}"}]}]}]}], "Input",
 CellChangeTimes->{{3.605976205935767*^9, 3.6059762273641033`*^9}, {
  3.605976336566934*^9, 3.60597649282242*^9}, {3.60598544532171*^9, 
  3.6059854574921227`*^9}, {3.606062323725559*^9, 3.606062333790209*^9}, {
  3.606332959832386*^9, 3.606333014367187*^9}, {3.606333115645891*^9, 
  3.606333138459887*^9}, {3.606333277140132*^9, 3.6063332830248213`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", "f"}], "+", 
   RowBox[{"l", " ", "m", " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", "+", "M"}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["y", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.605976351428172*^9, 3.605976430129455*^9}, {
   3.605976481817132*^9, 3.605976493194154*^9}, 3.605977849868903*^9, 
   3.605984748169718*^9, 3.60598546223773*^9, 3.6060561768801947`*^9, 
   3.6060608428248796`*^9, 3.6060611426247168`*^9, 3.606062397136218*^9, 
   3.60606476543435*^9, 3.606065236596776*^9, {3.606065275328137*^9, 
   3.6060653015106277`*^9}, 3.606066442121314*^9, 3.60608260250426*^9, 
   3.606082634637411*^9, 3.606082673513713*^9, 3.6060831498954372`*^9, {
   3.606083208510172*^9, 3.606083224200952*^9}, {3.606083270832395*^9, 
   3.606083290847048*^9}, {3.6060834113993607`*^9, 3.606083424316391*^9}, {
   3.606083473220859*^9, 3.606083526140999*^9}, 3.606083686459135*^9, 
   3.606083833586589*^9, {3.606132914185533*^9, 3.60613295708288*^9}, 
   3.606132999204576*^9, 3.606134988111198*^9, {3.6063329724023657`*^9, 
   3.606333015310227*^9}, 3.6063330772641563`*^9, {3.606333111316434*^9, 
   3.606333139411409*^9}, 3.6063332844356956`*^9, 3.606333660026533*^9, 
   3.6063344255735273`*^9, 3.606334958660727*^9, 3.606335117038146*^9, 
   3.606335402309462*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"l", " ", "m", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"g", " ", 
       RowBox[{"\[Theta]", "(", "t", ")"}]}]}], "+", 
     RowBox[{"l", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["y", "\[Prime]\[Prime]",
       MultilineFunction->None], "(", "t", ")"}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.605976351428172*^9, 3.605976430129455*^9}, {
   3.605976481817132*^9, 3.605976493194154*^9}, 3.605977849868903*^9, 
   3.605984748169718*^9, 3.60598546223773*^9, 3.6060561768801947`*^9, 
   3.6060608428248796`*^9, 3.6060611426247168`*^9, 3.606062397136218*^9, 
   3.60606476543435*^9, 3.606065236596776*^9, {3.606065275328137*^9, 
   3.6060653015106277`*^9}, 3.606066442121314*^9, 3.60608260250426*^9, 
   3.606082634637411*^9, 3.606082673513713*^9, 3.6060831498954372`*^9, {
   3.606083208510172*^9, 3.606083224200952*^9}, {3.606083270832395*^9, 
   3.606083290847048*^9}, {3.6060834113993607`*^9, 3.606083424316391*^9}, {
   3.606083473220859*^9, 3.606083526140999*^9}, 3.606083686459135*^9, 
   3.606083833586589*^9, {3.606132914185533*^9, 3.60613295708288*^9}, 
   3.606132999204576*^9, 3.606134988111198*^9, {3.6063329724023657`*^9, 
   3.606333015310227*^9}, 3.6063330772641563`*^9, {3.606333111316434*^9, 
   3.606333139411409*^9}, 3.6063332844356956`*^9, 3.606333660026533*^9, 
   3.6063344255735273`*^9, 3.606334958660727*^9, 3.606335117038146*^9, 
   3.606335402313727*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Collect", "[", 
  RowBox[{"leqn1", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "''"}], "[", "t", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{"leqn2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"y", "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]", "''"}], "[", "t", "]"}]}], "}"}]}], "]"}]}], "Input",\

 CellChangeTimes->{{3.604805525509398*^9, 3.6048055286852818`*^9}, {
   3.604805580122101*^9, 3.604805645074325*^9}, {3.605975561707066*^9, 
   3.605975588832704*^9}, 3.605976441072281*^9, 3.6059764991501217`*^9, {
   3.6059854672356462`*^9, 3.605985476611609*^9}, {3.6063331475486*^9, 
   3.606333168156034*^9}, {3.6063332902843943`*^9, 3.606333294247875*^9}, {
   3.606333364911118*^9, 3.606333371479866*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", "f"}], "+", 
   RowBox[{"l", " ", "m", " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"m", "+", "M"}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["y", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.604805529330908*^9, 3.604805615218313*^9, 3.604805645702003*^9, 
   3.604847901735227*^9, 3.604848386330194*^9, 3.604852828350754*^9, 
   3.604854957165372*^9, 3.604856126402893*^9, 3.604872362000404*^9, 
   3.605975589177782*^9, {3.605976437495226*^9, 3.605976441344075*^9}, {
   3.6059764965451717`*^9, 3.60597649942304*^9}, 3.605977851732655*^9, 
   3.605984748271934*^9, 3.605985477782193*^9, 3.6060561769288187`*^9, 
   3.606060842867441*^9, 3.606061143848343*^9, 3.606062397185429*^9, 
   3.6060647654841967`*^9, 3.606065236652707*^9, {3.606065275376589*^9, 
   3.606065301577229*^9}, 3.606066442188479*^9, 3.606082602565214*^9, 
   3.606082634687838*^9, 3.606082673577385*^9, 3.606083149954186*^9, {
   3.606083208575363*^9, 3.606083224268681*^9}, {3.606083270885355*^9, 
   3.606083290894786*^9}, {3.606083411466145*^9, 3.6060834243642073`*^9}, {
   3.606083473268873*^9, 3.606083526219103*^9}, 3.6060836865255547`*^9, 
   3.606083833635504*^9, {3.606132914238997*^9, 3.606132957127825*^9}, 
   3.606132999254973*^9, 3.60613498817476*^9, {3.6063331580796347`*^9, 
   3.606333173656746*^9}, 3.606333295894844*^9, 3.606333373016789*^9, 
   3.6063336741318808`*^9, 3.606334425628682*^9, 3.606334958726915*^9, 
   3.6063351171062603`*^9, 3.606335402377767*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"l", " ", "m", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["y", "\[Prime]\[Prime]",
        MultilineFunction->None], "(", "t", ")"}], "-", 
      RowBox[{"g", " ", 
       RowBox[{"\[Theta]", "(", "t", ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["l", "2"], " ", "m", " ", 
    RowBox[{
     SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.604805529330908*^9, 3.604805615218313*^9, 3.604805645702003*^9, 
   3.604847901735227*^9, 3.604848386330194*^9, 3.604852828350754*^9, 
   3.604854957165372*^9, 3.604856126402893*^9, 3.604872362000404*^9, 
   3.605975589177782*^9, {3.605976437495226*^9, 3.605976441344075*^9}, {
   3.6059764965451717`*^9, 3.60597649942304*^9}, 3.605977851732655*^9, 
   3.605984748271934*^9, 3.605985477782193*^9, 3.6060561769288187`*^9, 
   3.606060842867441*^9, 3.606061143848343*^9, 3.606062397185429*^9, 
   3.6060647654841967`*^9, 3.606065236652707*^9, {3.606065275376589*^9, 
   3.606065301577229*^9}, 3.606066442188479*^9, 3.606082602565214*^9, 
   3.606082634687838*^9, 3.606082673577385*^9, 3.606083149954186*^9, {
   3.606083208575363*^9, 3.606083224268681*^9}, {3.606083270885355*^9, 
   3.606083290894786*^9}, {3.606083411466145*^9, 3.6060834243642073`*^9}, {
   3.606083473268873*^9, 3.606083526219103*^9}, 3.6060836865255547`*^9, 
   3.606083833635504*^9, {3.606132914238997*^9, 3.606132957127825*^9}, 
   3.606132999254973*^9, 3.60613498817476*^9, {3.6063331580796347`*^9, 
   3.606333173656746*^9}, 3.606333295894844*^9, 3.606333373016789*^9, 
   3.6063336741318808`*^9, 3.606334425628682*^9, 3.606334958726915*^9, 
   3.6063351171062603`*^9, 3.606335402386305*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Let", " ", "state", " ", "vector", " ", "x"}], " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
    "y", ",", " ", "\[Theta]", ",", " ", "yt", ",", " ", "\[Theta]t"}], 
    ")"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.606333402814021*^9, 3.6063334182843637`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Solve", " ", "for", " ", "state", " ", "space", " ", "equations"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sol", " ", "=", " ", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"leqn1", "\[Equal]", "0"}], ",", 
         RowBox[{"leqn2", "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"y", "''"}], "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{"\[Theta]", "''"}], "[", "t", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"p1", " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"sol", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"y", "[", "t", "]"}], ",", " ", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"p2", " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"sol", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"y", "[", "t", "]"}], ",", " ", 
        RowBox[{"\[Theta]", "[", "t", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"a22", " ", "=", " ", 
    RowBox[{
     RowBox[{"p1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], "/.", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "1"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"a32", " ", "=", " ", 
    RowBox[{
     RowBox[{"p2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], "/.", 
     RowBox[{
      RowBox[{"\[Theta]", "[", "t", "]"}], "\[Rule]", "1"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"b1", " ", "=", " ", 
    RowBox[{
     RowBox[{"p1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "/.", " ", 
     RowBox[{"f", "\[Rule]", "1"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"b2", " ", "=", " ", 
    RowBox[{
     RowBox[{"p2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "/.", " ", 
     RowBox[{"f", "\[Rule]", "1"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.6048034368818703`*^9, 3.604803472525948*^9}, {
   3.604805709726656*^9, 3.604806071984168*^9}, {3.604920167972171*^9, 
   3.6049201758737173`*^9}, {3.605976509572876*^9, 3.605976555035275*^9}, 
   3.605976609412343*^9, {3.6059766494966373`*^9, 3.605976834508479*^9}, {
   3.6059768652113247`*^9, 3.605976891179995*^9}, {3.6059854827248487`*^9, 
   3.6059855238369617`*^9}, {3.605985622656598*^9, 3.605985694263084*^9}, {
   3.606061093396781*^9, 3.606061161624701*^9}, {3.60606231443097*^9, 
   3.606062315302566*^9}, {3.6063331831912403`*^9, 3.60633319800287*^9}, {
   3.6063332294296703`*^9, 3.6063332358507147`*^9}, {3.606333305552567*^9, 
   3.606333326114719*^9}, {3.606333378242413*^9, 3.606333387434039*^9}, {
   3.60633348643056*^9, 3.606333500085647*^9}, {3.606333538723114*^9, 
   3.606333583289427*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["y", "\[Prime]\[Prime]",
     MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
   RowBox[{
    FractionBox["f", "M"], "-", 
    FractionBox[
     RowBox[{"g", " ", "m", " ", 
      RowBox[{"\[Theta]", "(", "t", ")"}]}], "M"]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.606333311003419*^9, 3.6063333292077436`*^9}, 
   3.606333390540183*^9, 3.606333554607299*^9, 3.6063335852896137`*^9, 
   3.606333676663974*^9, 3.606334425787518*^9, 3.606334958834037*^9, 
   3.606335117266193*^9, 3.6063354024705772`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Theta]", "\[Prime]\[Prime]",
     MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["f", 
      RowBox[{"l", " ", "M"}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Theta]", "(", "t", ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"g", " ", "m"}]}], "-", 
        RowBox[{"g", " ", "M"}]}], ")"}]}], 
     RowBox[{"l", " ", "M"}]]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.606333311003419*^9, 3.6063333292077436`*^9}, 
   3.606333390540183*^9, 3.606333554607299*^9, 3.6063335852896137`*^9, 
   3.606333676663974*^9, 3.606334425787518*^9, 3.606334958834037*^9, 
   3.606335117266193*^9, 3.606335402501597*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{"g", " ", "m"}], "M"]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.606333311003419*^9, 3.6063333292077436`*^9}, 
   3.606333390540183*^9, 3.606333554607299*^9, 3.6063335852896137`*^9, 
   3.606333676663974*^9, 3.606334425787518*^9, 3.606334958834037*^9, 
   3.606335117266193*^9, 3.606335402504661*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      RowBox[{"g", " ", "m"}]}], "-", 
     RowBox[{"g", " ", "M"}]}], 
    RowBox[{"l", " ", "M"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.606333311003419*^9, 3.6063333292077436`*^9}, 
   3.606333390540183*^9, 3.606333554607299*^9, 3.6063335852896137`*^9, 
   3.606333676663974*^9, 3.606334425787518*^9, 3.606334958834037*^9, 
   3.606335117266193*^9, 3.6063354025078773`*^9}],

Cell[BoxData[
 FormBox[
  FractionBox["1", "M"], TraditionalForm]], "Output",
 CellChangeTimes->{{3.606333311003419*^9, 3.6063333292077436`*^9}, 
   3.606333390540183*^9, 3.606333554607299*^9, 3.6063335852896137`*^9, 
   3.606333676663974*^9, 3.606334425787518*^9, 3.606334958834037*^9, 
   3.606335117266193*^9, 3.606335402510724*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox["1", 
    RowBox[{"l", " ", "M"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.606333311003419*^9, 3.6063333292077436`*^9}, 
   3.606333390540183*^9, 3.606333554607299*^9, 3.6063335852896137`*^9, 
   3.606333676663974*^9, 3.606334425787518*^9, 3.606334958834037*^9, 
   3.606335117266193*^9, 3.606335402513019*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"State", " ", "space", " ", "matrix"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"A", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", " ", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "a22", ",", "0", ",", "0"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0", ",", "a32", ",", "0", ",", "0"}], "}"}]}], "}"}], " ", "/.",
      "parameters"}]}], "\[IndentingNewLine]", 
   RowBox[{"B", " ", "=", " ", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "0", "}"}], ",", 
       RowBox[{"{", "b1", "}"}], ",", 
       RowBox[{"{", "b2", "}"}]}], "}"}], " ", "/.", 
     "parameters"}]}]}]}]], "Input",
 CellChangeTimes->{{3.604803483042338*^9, 3.604803486964986*^9}, {
  3.604805660697*^9, 3.60480569772714*^9}, {3.604806077448135*^9, 
  3.604806101606605*^9}, {3.604920179980824*^9, 3.6049201861314707`*^9}, {
  3.605976575135672*^9, 3.605976641666122*^9}, {3.605976850671426*^9, 
  3.605976852797145*^9}, {3.605976896469544*^9, 3.6059769065851717`*^9}, {
  3.60597702126826*^9, 3.6059770342254333`*^9}, {3.60598472980851*^9, 
  3.6059847723234*^9}, {3.605985627521777*^9, 3.6059856417440777`*^9}, {
  3.6059856784799*^9, 3.605985683592853*^9}, {3.6063334446227293`*^9, 
  3.6063335037485857`*^9}, {3.6063335594531593`*^9, 3.606333600706846*^9}, {
  3.606334091255105*^9, 3.606334096179613*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {"0", 
      RowBox[{"-", "4.905`"}], "0", "0"},
     {"0", "7.3575`", "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.604805685560153*^9, {3.604806097490699*^9, 3.604806102456605*^9}, 
   3.604847906576515*^9, 3.604848391116088*^9, 3.604852828621973*^9, 
   3.6048549574821243`*^9, 3.604856126713599*^9, 3.604872362338916*^9, 
   3.605976599172155*^9, 3.605976645949355*^9, 3.6059768377606277`*^9, 
   3.605976907200419*^9, {3.605977027765252*^9, 3.605977034797621*^9}, 
   3.6059778626049337`*^9, {3.6059847429024763`*^9, 3.6059847731763563`*^9}, 
   3.605985697312337*^9, 3.606056177027391*^9, 3.60606084297022*^9, 
   3.606061168681691*^9, 3.606062397284177*^9, 3.6060647656299267`*^9, 
   3.6060652367852173`*^9, {3.606065275487371*^9, 3.606065301691169*^9}, 
   3.606066442297607*^9, 3.606082602683894*^9, 3.606082634805729*^9, 
   3.606082673701091*^9, 3.6060831500896063`*^9, {3.606083208724115*^9, 
   3.606083224398409*^9}, {3.606083271052648*^9, 3.6060832910612783`*^9}, {
   3.606083411595887*^9, 3.6060834244956417`*^9}, {3.60608347339914*^9, 
   3.60608352637332*^9}, 3.606083686655815*^9, 3.6060838337708797`*^9, {
   3.606132914355597*^9, 3.60613295722567*^9}, 3.6061329993703203`*^9, 
   3.606134988321196*^9, {3.606333594937702*^9, 3.606333601014112*^9}, {
   3.606333705581419*^9, 3.606333728321433*^9}, 3.606334096780262*^9, 
   3.606334425940674*^9, 3.6063349590849667`*^9, 3.606335117419166*^9, 
   3.60633540257242*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"0"},
     {
      FractionBox["1", "100"]},
     {
      RowBox[{"-", 
       FractionBox["1", "200"]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.604805685560153*^9, {3.604806097490699*^9, 3.604806102456605*^9}, 
   3.604847906576515*^9, 3.604848391116088*^9, 3.604852828621973*^9, 
   3.6048549574821243`*^9, 3.604856126713599*^9, 3.604872362338916*^9, 
   3.605976599172155*^9, 3.605976645949355*^9, 3.6059768377606277`*^9, 
   3.605976907200419*^9, {3.605977027765252*^9, 3.605977034797621*^9}, 
   3.6059778626049337`*^9, {3.6059847429024763`*^9, 3.6059847731763563`*^9}, 
   3.605985697312337*^9, 3.606056177027391*^9, 3.60606084297022*^9, 
   3.606061168681691*^9, 3.606062397284177*^9, 3.6060647656299267`*^9, 
   3.6060652367852173`*^9, {3.606065275487371*^9, 3.606065301691169*^9}, 
   3.606066442297607*^9, 3.606082602683894*^9, 3.606082634805729*^9, 
   3.606082673701091*^9, 3.6060831500896063`*^9, {3.606083208724115*^9, 
   3.606083224398409*^9}, {3.606083271052648*^9, 3.6060832910612783`*^9}, {
   3.606083411595887*^9, 3.6060834244956417`*^9}, {3.60608347339914*^9, 
   3.60608352637332*^9}, 3.606083686655815*^9, 3.6060838337708797`*^9, {
   3.606132914355597*^9, 3.60613295722567*^9}, 3.6061329993703203`*^9, 
   3.606134988321196*^9, {3.606333594937702*^9, 3.606333601014112*^9}, {
   3.606333705581419*^9, 3.606333728321433*^9}, 3.606334096780262*^9, 
   3.606334425940674*^9, 3.6063349590849667`*^9, 3.606335117419166*^9, 
   3.606335402576673*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q", " ", "=", " ", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Flatten", "[", "B", "]"}], ",", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"A", ".", "B"}], "]"}], ",", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"A", ".", "A", ".", "B"}], "]"}], ",", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"A", ".", "A", ".", "A", ".", "B"}], "]"}]}], "}"}], " ", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.605976910070673*^9, 3.6059769359948683`*^9}, {
  3.6059770079538717`*^9, 3.605977014783869*^9}, {3.6059773160653543`*^9, 
  3.605977318433234*^9}, {3.605977870183344*^9, 3.605977871546959*^9}, {
  3.60598570358638*^9, 3.605985704086526*^9}, {3.606056218626574*^9, 
  3.6060562231984253`*^9}, {3.6060833215932083`*^9, 3.606083327951441*^9}, {
  3.606333608464148*^9, 3.60633362077641*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0.01`", "0.`", "0.024525`"},
     {"0", 
      RowBox[{"-", "0.005`"}], "0.`", 
      RowBox[{"-", "0.0367875`"}]},
     {
      FractionBox["1", "100"], "0.`", "0.024525`", "0.`"},
     {
      RowBox[{"-", 
       FractionBox["1", "200"]}], "0.`", 
      RowBox[{"-", "0.0367875`"}], "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.6059770052795143`*^9, 3.605977041712152*^9}, 
   3.6059773193068743`*^9, {3.605977840470057*^9, 3.6059778722329817`*^9}, 
   3.605984748479261*^9, 3.605985704767682*^9, 3.606056177076964*^9, 
   3.6060562236689672`*^9, 3.606060843159679*^9, 3.606061170476179*^9, 
   3.6060623973320637`*^9, 3.606064765708461*^9, 3.606065236843131*^9, {
   3.606065275558234*^9, 3.6060653017589293`*^9}, 3.6060664423671007`*^9, 
   3.606082602750154*^9, 3.606082634870969*^9, 3.606082673773878*^9, 
   3.606083150153945*^9, {3.606083208788673*^9, 3.60608322446603*^9}, {
   3.60608327111294*^9, 3.60608329112847*^9}, 3.606083328387286*^9, {
   3.606083411668973*^9, 3.606083424575499*^9}, {3.60608347346379*^9, 
   3.606083526452091*^9}, 3.606083686720849*^9, 3.606083833837515*^9, {
   3.606132914400895*^9, 3.6061329572749567`*^9}, 3.606132999416477*^9, 
   3.606134988387838*^9, 3.606333625109864*^9, 3.6063337308863907`*^9, 
   3.606334101195919*^9, 3.606334426002379*^9, 3.6063349591506977`*^9, 
   3.6063351174755793`*^9, 3.606335402621377*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Matrix", " ", "Rank", " ", "of", " ", "Q"}], " ", "=", " ", 
     "N"}], ",", " ", 
    RowBox[{
    "so", " ", "the", " ", "system", " ", "is", " ", "controllable"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixRank", "[", "Q", "]"}]}]], "Input",
 CellChangeTimes->{{3.605978044776095*^9, 3.605978089354352*^9}, {
  3.605985767487543*^9, 3.6059857680958652`*^9}, {3.60598580916875*^9, 
  3.605985810656893*^9}}],

Cell[BoxData[
 FormBox["4", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.605978048001526*^9, 3.605984748988936*^9, {3.605985765475752*^9, 
   3.6059857694814253`*^9}, 3.605985812047233*^9, 3.606056177274412*^9, 
   3.606060843391005*^9, 3.606061179089579*^9, 3.6060623975291348`*^9, 
   3.606064765941943*^9, 3.606065237057177*^9, {3.6060652757830687`*^9, 
   3.60606530198254*^9}, 3.606066442710498*^9, 3.6060826029450083`*^9, 
   3.606082635132267*^9, 3.6060826740185347`*^9, 3.606083150385635*^9, {
   3.6060832090980997`*^9, 3.606083224725856*^9}, {3.6060832713061543`*^9, 
   3.606083291396947*^9}, {3.6060834117260427`*^9, 3.606083424623921*^9}, {
   3.606083473525629*^9, 3.606083526511297*^9}, 3.606083686786042*^9, 
   3.606083833884954*^9, {3.606132914454763*^9, 3.606132957324258*^9}, 
   3.606132999467667*^9, 3.6061349884528303`*^9, 3.606333733646443*^9, 
   3.6063341030570107`*^9, 3.606334426065366*^9, 3.606334959197975*^9, 
   3.606335117524128*^9, 3.606335402669455*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"T1", " ", "=", " ", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ".", 
   RowBox[{"Inverse", "[", "Q", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"T", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"Flatten", "[", 
     RowBox[{"{", "T1", "}"}], "]"}], ",", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"T1", ".", "A"}], "}"}], "]"}], ",", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"T1", ".", "A", ".", "A"}], "}"}], "]"}], ",", " ", 
    RowBox[{"Flatten", "[", 
     RowBox[{"{", 
      RowBox[{"T1", ".", "A", ".", "A", ".", "A"}], "}"}], "]"}]}], 
   "}"}]}]}], "Input",
 CellChangeTimes->{{3.606056164767975*^9, 3.606056169191308*^9}, {
  3.6060833415607986`*^9, 3.606083399998064*^9}, {3.606333746656782*^9, 
  3.606333785104004*^9}, {3.6063340126117287`*^9, 3.606334049863536*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "20.387359836901123`"}], ",", 
    RowBox[{"-", "40.774719673802245`"}], ",", "0.`", ",", "0.`"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.606333765738956*^9, 3.6063337858578863`*^9}, {
   3.606334016094467*^9, 3.606334050307399*^9}, 3.606334104668281*^9, 
   3.606334426114006*^9, 3.606334959244979*^9, 3.606335117574251*^9, 
   3.606335402768529*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "20.387359836901123`"}], 
      RowBox[{"-", "40.774719673802245`"}], "0.`", "0.`"},
     {"0.`", "0.`", 
      RowBox[{"-", "20.387359836901123`"}], 
      RowBox[{"-", "40.774719673802245`"}]},
     {"0.`", 
      RowBox[{"-", "200.`"}], "0.`", "0.`"},
     {"0.`", "0.`", "0.`", 
      RowBox[{"-", "200.`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.606333765738956*^9, 3.6063337858578863`*^9}, {
   3.606334016094467*^9, 3.606334050307399*^9}, 3.606334104668281*^9, 
   3.606334426114006*^9, 3.606334959244979*^9, 3.606335117574251*^9, 
   3.6063354027724047`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"A1", " ", "=", " ", 
  RowBox[{"T", ".", "A", ".", 
   RowBox[{"Inverse", "[", "T", "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"B1", " ", "=", " ", 
  RowBox[{"T", ".", "B"}]}]}], "Input",
 CellChangeTimes->{{3.6063340559204283`*^9, 3.6063340722300243`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "1.`", "0.`", "0.`"},
     {"0.`", "0.`", "1.`", "0.`"},
     {"0.`", "0.`", "0.`", "1.`"},
     {"0.`", "0.`", "7.3575`", "0.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056265175099*^9, 3.606060843541044*^9, 3.606061183993815*^9, 
   3.606062397675848*^9, 3.606064766092329*^9, 3.606065237237586*^9, {
   3.606065275965867*^9, 3.606065302151464*^9}, 3.606066443157941*^9, 
   3.6060826031419783`*^9, 3.606082635328134*^9, 3.6060826743634653`*^9, 
   3.606083150578478*^9, {3.606083209438593*^9, 3.6060832249223623`*^9}, {
   3.606083271469079*^9, 3.606083291580761*^9}, {3.6060834048877497`*^9, 
   3.606083424751417*^9}, {3.606083473658527*^9, 3.606083526665275*^9}, 
   3.606083686912929*^9, 3.6060838339996223`*^9, {3.606132914590272*^9, 
   3.6061329574429293`*^9}, 3.606132999569414*^9, 3.606134988584124*^9, 
   3.606333814201662*^9, {3.6063340537729263`*^9, 3.606334058219268*^9}, 
   3.6063341065389013`*^9, 3.606334426192602*^9, 3.606334959508089*^9, 
   3.6063351178668747`*^9, 3.606335402819211*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`"},
     {"0.`"},
     {"0.`"},
     {"1.`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056265175099*^9, 3.606060843541044*^9, 3.606061183993815*^9, 
   3.606062397675848*^9, 3.606064766092329*^9, 3.606065237237586*^9, {
   3.606065275965867*^9, 3.606065302151464*^9}, 3.606066443157941*^9, 
   3.6060826031419783`*^9, 3.606082635328134*^9, 3.6060826743634653`*^9, 
   3.606083150578478*^9, {3.606083209438593*^9, 3.6060832249223623`*^9}, {
   3.606083271469079*^9, 3.606083291580761*^9}, {3.6060834048877497`*^9, 
   3.606083424751417*^9}, {3.606083473658527*^9, 3.606083526665275*^9}, 
   3.606083686912929*^9, 3.6060838339996223`*^9, {3.606132914590272*^9, 
   3.6061329574429293`*^9}, 3.606132999569414*^9, 3.606134988584124*^9, 
   3.606333814201662*^9, {3.6063340537729263`*^9, 3.606334058219268*^9}, 
   3.6063341065389013`*^9, 3.606334426192602*^9, 3.606334959508089*^9, 
   3.6063351178668747`*^9, 3.6063354028231287`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"gz", ",", "bg"}], "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Gz", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"gz", ",", "4"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"B1Gz", "=", 
   RowBox[{"Array", "[", 
    RowBox[{"bg", ",", 
     RowBox[{"{", 
      RowBox[{"4", ",", "4"}], "}"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Do", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"bg", "[", 
      RowBox[{"i", ",", "j"}], "]"}], "=", 
     RowBox[{
      RowBox[{"B1", "[", 
       RowBox[{"[", "i", "]"}], "]"}], " ", 
      RowBox[{"gz", "[", "j", "]"}]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "4"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"j", ",", "1", ",", "4"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", "B1Gz"}], "Input",
 CellChangeTimes->{{3.6060562752092113`*^9, 3.6060562839009867`*^9}, {
  3.606333828683878*^9, 3.60633383467694*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"{", "0.`", "}"}], 
      RowBox[{"{", "0.`", "}"}], 
      RowBox[{"{", "0.`", "}"}], 
      RowBox[{"{", "0.`", "}"}]},
     {
      RowBox[{"{", "0.`", "}"}], 
      RowBox[{"{", "0.`", "}"}], 
      RowBox[{"{", "0.`", "}"}], 
      RowBox[{"{", "0.`", "}"}]},
     {
      RowBox[{"{", "0.`", "}"}], 
      RowBox[{"{", "0.`", "}"}], 
      RowBox[{"{", "0.`", "}"}], 
      RowBox[{"{", "0.`", "}"}]},
     {
      RowBox[{"{", 
       RowBox[{"1.`", " ", 
        RowBox[{"gz", "(", "1", ")"}]}], "}"}], 
      RowBox[{"{", 
       RowBox[{"1.`", " ", 
        RowBox[{"gz", "(", "2", ")"}]}], "}"}], 
      RowBox[{"{", 
       RowBox[{"1.`", " ", 
        RowBox[{"gz", "(", "3", ")"}]}], "}"}], 
      RowBox[{"{", 
       RowBox[{"1.`", " ", 
        RowBox[{"gz", "(", "4", ")"}]}], "}"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.60605627273417*^9, 3.606056284433735*^9}, 
   3.606060843586008*^9, 3.606061185848585*^9, 3.6060623977246323`*^9, 
   3.606064766158662*^9, 3.606065237288506*^9, {3.6060652761926527`*^9, 
   3.6060653022183104`*^9}, 3.6060664432180233`*^9, 3.606082603288813*^9, 
   3.606082635411302*^9, 3.6060826744281893`*^9, 3.6060831506273127`*^9, {
   3.6060832095076637`*^9, 3.606083224991591*^9}, {3.606083271523737*^9, 
   3.606083291646923*^9}, {3.606083411888555*^9, 3.606083424819446*^9}, {
   3.6060834737258873`*^9, 3.606083526739023*^9}, 3.606083687033526*^9, 
   3.606083834061283*^9, {3.6061329146312523`*^9, 3.60613295749231*^9}, 
   3.606132999631494*^9, 3.6061349886492977`*^9, 3.606333835291774*^9, 
   3.606334112505665*^9, 3.6063344262680693`*^9, 3.606334959577407*^9, 
   3.60633511792163*^9, 3.6063354028894567`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"B1Gz", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"gz", "[", "1", "]"}], ",", 
      RowBox[{"gz", "[", "2", "]"}], ",", 
      RowBox[{"gz", "[", "3", "]"}], ",", " ", 
      RowBox[{"gz", "[", "4", "]"}]}], "}"}]}], "}"}]}]], "Input",
 CellChangeTimes->{{3.606056303468852*^9, 3.6060563106280003`*^9}, {
  3.606333856755157*^9, 3.6063338721389503`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {"0", "0", "0", "0"},
     {
      RowBox[{"gz", "(", "1", ")"}], 
      RowBox[{"gz", "(", "2", ")"}], 
      RowBox[{"gz", "(", "3", ")"}], 
      RowBox[{"gz", "(", "4", ")"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056311304682*^9, 3.606060843637618*^9, 3.6060611873287497`*^9, 
   3.606062397772647*^9, 3.606064766208934*^9, 3.6060652373429403`*^9, {
   3.606065276243429*^9, 3.6060653024061413`*^9}, 3.606066443266429*^9, 
   3.606082603502653*^9, 3.606082635591569*^9, 3.6060826744748087`*^9, 
   3.6060831508061047`*^9, {3.60608320957263*^9, 3.606083225216332*^9}, {
   3.606083271694655*^9, 3.6060832919705477`*^9}, {3.606083412069583*^9, 
   3.606083424863291*^9}, {3.606083473782509*^9, 3.60608352680546*^9}, 
   3.606083687090987*^9, 3.6060838341111307`*^9, {3.606132914676422*^9, 
   3.60613295754065*^9}, 3.606132999681307*^9, 3.6061349886916656`*^9, 
   3.6063338732445507`*^9, 3.606334116379354*^9, 3.6063344264743557`*^9, 
   3.606334959664588*^9, 3.606335117986758*^9, 3.6063354030755444`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"A1star", "=", 
  RowBox[{"A1", "-", "B1Gz"}]}]], "Input"],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.`", "1.`", "0.`", "0.`"},
     {"0.`", "0.`", "1.`", "0.`"},
     {"0.`", "0.`", "0.`", "1.`"},
     {
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"gz", "(", "1", ")"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"gz", "(", "2", ")"}]}], 
      RowBox[{"7.3575`", "\[VeryThinSpace]", "-", 
       RowBox[{"gz", "(", "3", ")"}]}], 
      RowBox[{"0.`", "\[VeryThinSpace]", "-", 
       RowBox[{"gz", "(", "4", ")"}]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056315326746*^9, 3.606060843687529*^9, 3.606061189584681*^9, 
   3.6060623978216543`*^9, 3.606064766394186*^9, 3.606065237529098*^9, {
   3.606065276285859*^9, 3.606065302456718*^9}, 3.6060664433087597`*^9, 
   3.6060826035695343`*^9, 3.606082635654706*^9, 3.606082674544046*^9, 
   3.606083150856089*^9, {3.606083209619979*^9, 3.606083225264657*^9}, {
   3.606083271750474*^9, 3.606083292039709*^9}, {3.606083412117198*^9, 
   3.606083424922155*^9}, {3.606083473842215*^9, 3.606083527068338*^9}, 
   3.606083687139183*^9, 3.606083834162621*^9, {3.6061329147266293`*^9, 
   3.6061329575847692`*^9}, 3.6061329997274647`*^9, 3.606134988887248*^9, 
   3.606333894958845*^9, 3.6063341203021107`*^9, 3.606334426522534*^9, 
   3.606334959724154*^9, 3.606335118055725*^9, 3.606335403124054*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"M1star", "=", 
   RowBox[{
    RowBox[{"s", " ", 
     RowBox[{"IdentityMatrix", "[", "4", "]"}]}], "-", "A1star"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"cpz", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Det", "[", "M1star", "]"}], ",", "s", ",", "Simplify"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6060563241269836`*^9, 3.606056324212618*^9}, {
  3.606083884088964*^9, 3.6060838887014914`*^9}, {3.6063341253516397`*^9, 
  3.606334125669656*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"gz", "(", "4", ")"}], " ", 
    SuperscriptBox["s", "3"]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1.`", " ", 
       RowBox[{"gz", "(", "3", ")"}]}], "-", "7.3575`"}], ")"}], " ", 
    SuperscriptBox["s", "2"]}], "+", 
   RowBox[{"1.`", " ", 
    RowBox[{"gz", "(", "2", ")"}], " ", "s"}], "+", 
   RowBox[{"1.`", " ", 
    RowBox[{"gz", "(", "1", ")"}]}], "+", 
   SuperscriptBox["s", "4"], "+", "0.`"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.60605632067457*^9, 3.606056324628907*^9}, 
   3.60606084386331*^9, 3.606061191251699*^9, 3.6060623978701982`*^9, 
   3.606064766447936*^9, 3.606065237580285*^9, {3.606065276334785*^9, 
   3.60606530250539*^9}, 3.606066443362287*^9, 3.606082603615242*^9, 
   3.606082635716195*^9, 3.60608267460599*^9, 3.606083150923318*^9, {
   3.6060832096870613`*^9, 3.6060832253320704`*^9}, {3.606083271795784*^9, 
   3.606083292088642*^9}, {3.6060834121623363`*^9, 3.606083425018054*^9}, {
   3.606083474038003*^9, 3.60608352716394*^9}, 3.6060836873092747`*^9, 
   3.606083834228477*^9, {3.606083884618473*^9, 3.6060838891441402`*^9}, {
   3.606132914774414*^9, 3.60613295763463*^9}, 3.6061329997753677`*^9, 
   3.606134988936927*^9, {3.606334122668054*^9, 3.606334126187587*^9}, 
   3.606334426588048*^9, 3.6063349597878113`*^9, 3.606335118128002*^9, 
   3.6063354031897287`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"cp0", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"s", "-", "s1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"s", "-", "s2"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"s", "-", "s3"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"s", "-", "s4"}], ")"}]}], ",", "s", ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6060563310126667`*^9, 3.606056331932748*^9}, {
  3.606334130773553*^9, 3.606334134005741*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   SuperscriptBox["s", "4"], "+", 
   RowBox[{
    SuperscriptBox["s", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "s1"}], "-", "s2", "-", "s3", "-", "s4"}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["s", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s1", " ", 
       RowBox[{"(", 
        RowBox[{"s2", "+", "s3", "+", "s4"}], ")"}]}], "+", 
      RowBox[{"s2", " ", 
       RowBox[{"(", 
        RowBox[{"s3", "+", "s4"}], ")"}]}], "+", 
      RowBox[{"s3", " ", "s4"}]}], ")"}]}], "+", 
   RowBox[{"s", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       RowBox[{"s1", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"s2", " ", 
           RowBox[{"(", 
            RowBox[{"s3", "+", "s4"}], ")"}]}], "+", 
          RowBox[{"s3", " ", "s4"}]}], ")"}]}]}], "-", 
      RowBox[{"s2", " ", "s3", " ", "s4"}]}], ")"}]}], "+", 
   RowBox[{"s1", " ", "s2", " ", "s3", " ", "s4"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056332702385*^9, 3.606060843913457*^9, 3.606061193033492*^9, 
   3.6060623979193583`*^9, 3.606064766495762*^9, 3.606065237630376*^9, {
   3.606065276384364*^9, 3.606065302553887*^9}, 3.60606644340702*^9, 
   3.606082603679433*^9, 3.606082635767023*^9, 3.6060826746550922`*^9, 
   3.6060831510341*^9, {3.606083209751658*^9, 3.606083225394924*^9}, {
   3.606083271865346*^9, 3.606083292152914*^9}, {3.60608341234759*^9, 
   3.6060834252161016`*^9}, {3.606083474081221*^9, 3.606083527230961*^9}, 
   3.606083687385686*^9, 3.606083834293232*^9, {3.6061329149206553`*^9, 
   3.606132957704072*^9}, 3.606132999846076*^9, 3.606134988989255*^9, 
   3.606334134521183*^9, 3.6063344266838713`*^9, 3.606334959881193*^9, 
   3.606335118223536*^9, 3.606335403290662*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"g1", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"cpz", ",", "s", ",", "3"}], "]"}], "-", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"cp0", ",", "s", ",", "3"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"g2", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"cpz", ",", "s", ",", "2"}], "]"}], "-", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"cp0", ",", "s", ",", "2"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"g3", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"cpz", ",", "s", ",", "1"}], "]"}], "-", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"cp0", ",", "s", ",", "1"}], "]"}]}]}], "\[IndentingNewLine]", 
 RowBox[{"g4", "=", 
  RowBox[{
   RowBox[{"Coefficient", "[", 
    RowBox[{"cpz", ",", "s", ",", "0"}], "]"}], "-", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"cp0", ",", "s", ",", "0"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.606056339564549*^9, 3.606056346556467*^9}, {
  3.6063341398769608`*^9, 3.606334151038828*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"gz", "(", "4", ")"}], "+", "s1", "+", "s2", "+", "s3", "+", 
   "s4"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056347121944*^9, 3.6060608439615307`*^9, 3.606061194276247*^9, 
   3.606062398088585*^9, 3.6060647665453377`*^9, 3.60606523768401*^9, {
   3.606065276433906*^9, 3.6060653026032877`*^9}, 3.606066443461583*^9, 
   3.6060826037249203`*^9, 3.606082635812454*^9, 3.606082674699813*^9, 
   3.606083151163525*^9, {3.6060832098172626`*^9, 3.60608322544298*^9}, {
   3.606083271909952*^9, 3.606083292218581*^9}, {3.606083412394279*^9, 
   3.6060834252727737`*^9}, {3.606083474129984*^9, 3.606083527295011*^9}, 
   3.606083687455092*^9, 3.6060838346081867`*^9, {3.6061329150859632`*^9, 
   3.6061329577482347`*^9}, 3.606132999889703*^9, 3.606134989039064*^9, 
   3.6063341517544203`*^9, 3.606334426734243*^9, 3.6063349599511557`*^9, 
   3.606335118281701*^9, 3.606335403373826*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"1.`", " ", 
    RowBox[{"gz", "(", "3", ")"}]}], "-", 
   RowBox[{"s1", " ", 
    RowBox[{"(", 
     RowBox[{"s2", "+", "s3", "+", "s4"}], ")"}]}], "-", 
   RowBox[{"s2", " ", 
    RowBox[{"(", 
     RowBox[{"s3", "+", "s4"}], ")"}]}], "-", 
   RowBox[{"s3", " ", "s4"}], "-", "7.3575`"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056347121944*^9, 3.6060608439615307`*^9, 3.606061194276247*^9, 
   3.606062398088585*^9, 3.6060647665453377`*^9, 3.60606523768401*^9, {
   3.606065276433906*^9, 3.6060653026032877`*^9}, 3.606066443461583*^9, 
   3.6060826037249203`*^9, 3.606082635812454*^9, 3.606082674699813*^9, 
   3.606083151163525*^9, {3.6060832098172626`*^9, 3.60608322544298*^9}, {
   3.606083271909952*^9, 3.606083292218581*^9}, {3.606083412394279*^9, 
   3.6060834252727737`*^9}, {3.606083474129984*^9, 3.606083527295011*^9}, 
   3.606083687455092*^9, 3.6060838346081867`*^9, {3.6061329150859632`*^9, 
   3.6061329577482347`*^9}, 3.606132999889703*^9, 3.606134989039064*^9, 
   3.6063341517544203`*^9, 3.606334426734243*^9, 3.6063349599511557`*^9, 
   3.606335118281701*^9, 3.6063354033786383`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"1.`", " ", 
    RowBox[{"gz", "(", "2", ")"}]}], "+", 
   RowBox[{"s1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"s2", " ", 
       RowBox[{"(", 
        RowBox[{"s3", "+", "s4"}], ")"}]}], "+", 
      RowBox[{"s3", " ", "s4"}]}], ")"}]}], "+", 
   RowBox[{"s2", " ", "s3", " ", "s4"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056347121944*^9, 3.6060608439615307`*^9, 3.606061194276247*^9, 
   3.606062398088585*^9, 3.6060647665453377`*^9, 3.60606523768401*^9, {
   3.606065276433906*^9, 3.6060653026032877`*^9}, 3.606066443461583*^9, 
   3.6060826037249203`*^9, 3.606082635812454*^9, 3.606082674699813*^9, 
   3.606083151163525*^9, {3.6060832098172626`*^9, 3.60608322544298*^9}, {
   3.606083271909952*^9, 3.606083292218581*^9}, {3.606083412394279*^9, 
   3.6060834252727737`*^9}, {3.606083474129984*^9, 3.606083527295011*^9}, 
   3.606083687455092*^9, 3.6060838346081867`*^9, {3.6061329150859632`*^9, 
   3.6061329577482347`*^9}, 3.606132999889703*^9, 3.606134989039064*^9, 
   3.6063341517544203`*^9, 3.606334426734243*^9, 3.6063349599511557`*^9, 
   3.606335118281701*^9, 3.606335403383*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"1.`", " ", 
    RowBox[{"gz", "(", "1", ")"}]}], "-", 
   RowBox[{"s1", " ", "s2", " ", "s3", " ", "s4"}], "+", "0.`"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056347121944*^9, 3.6060608439615307`*^9, 3.606061194276247*^9, 
   3.606062398088585*^9, 3.6060647665453377`*^9, 3.60606523768401*^9, {
   3.606065276433906*^9, 3.6060653026032877`*^9}, 3.606066443461583*^9, 
   3.6060826037249203`*^9, 3.606082635812454*^9, 3.606082674699813*^9, 
   3.606083151163525*^9, {3.6060832098172626`*^9, 3.60608322544298*^9}, {
   3.606083271909952*^9, 3.606083292218581*^9}, {3.606083412394279*^9, 
   3.6060834252727737`*^9}, {3.606083474129984*^9, 3.606083527295011*^9}, 
   3.606083687455092*^9, 3.6060838346081867`*^9, {3.6061329150859632`*^9, 
   3.6061329577482347`*^9}, 3.606132999889703*^9, 3.606134989039064*^9, 
   3.6063341517544203`*^9, 3.606334426734243*^9, 3.6063349599511557`*^9, 
   3.606335118281701*^9, 3.606335403439739*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", 
   RowBox[{"gz", ",", "s1", ",", "s2", ",", "s3", ",", "s4"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"g1", "\[Equal]", "0"}], ",", 
      RowBox[{"g2", "\[Equal]", "0"}], ",", " ", 
      RowBox[{"g3", "\[Equal]", "0"}], ",", 
      RowBox[{"g4", "\[Equal]", "0"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"gz", "[", "1", "]"}], ",", 
      RowBox[{"gz", "[", "2", "]"}], ",", 
      RowBox[{"gz", "[", "3", "]"}], ",", 
      RowBox[{"gz", "[", "4", "]"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"gz", "[", "1", "]"}], ",", 
     RowBox[{"gz", "[", "2", "]"}], ",", 
     RowBox[{"gz", "[", "3", "]"}], ",", 
     RowBox[{"gz", "[", "4", "]"}]}], "}"}], "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"gz", "[", "1", "]"}], ",", 
      RowBox[{"gz", "[", "2", "]"}], ",", 
      RowBox[{"gz", "[", "3", "]"}], ",", 
      RowBox[{"gz", "[", "4", "]"}]}], "}"}], "/.", 
    RowBox[{"%", "[", 
     RowBox[{"[", "1", "]"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"zgains", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"gz", "[", "1", "]"}], ",", 
    RowBox[{"gz", "[", "2", "]"}], ",", 
    RowBox[{"gz", "[", "3", "]"}], ",", 
    RowBox[{"gz", "[", "4", "]"}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.60605636666291*^9, 3.606056380179535*^9}, {
  3.6063341559020367`*^9, 3.606334189191099*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"1.`", " ", "s1", " ", "s2", " ", "s3", " ", "s4"}], "+", 
     "0.`"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"s1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s2", " ", 
          RowBox[{"(", 
           RowBox[{"s3", "+", "s4"}], ")"}]}], "+", 
         RowBox[{"s3", " ", "s4"}]}], ")"}]}]}], "-", 
     RowBox[{"s2", " ", "s3", " ", "s4"}]}], ",", 
    RowBox[{
     RowBox[{"1.`", " ", "s1", " ", 
      RowBox[{"(", 
       RowBox[{"s2", "+", "s3", "+", "s4"}], ")"}]}], "+", 
     RowBox[{"1.`", " ", "s2", " ", 
      RowBox[{"(", 
       RowBox[{"s3", "+", "s4"}], ")"}]}], "+", 
     RowBox[{"1.`", " ", "s3", " ", "s4"}], "+", "7.3575`"}], ",", 
    RowBox[{
     RowBox[{"-", "s1"}], "-", "s2", "-", "s3", "-", "s4"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.60605638071146*^9, 3.606060844010316*^9, 3.606061196646738*^9, 
   3.60606239813619*^9, 3.606064766597762*^9, 3.606065237742857*^9, {
   3.6060652764819603`*^9, 3.60606530265203*^9}, 3.6060664435260067`*^9, 
   3.606082603793923*^9, 3.606082635860004*^9, 3.606082674752797*^9, 
   3.606083151263152*^9, {3.606083209881946*^9, 3.606083225513257*^9}, {
   3.606083271979783*^9, 3.606083292283946*^9}, {3.60608341246275*^9, 
   3.606083425328148*^9}, {3.6060834741992292`*^9, 3.60608352738234*^9}, 
   3.606083687536332*^9, 3.6060838346706047`*^9, {3.6061329151372223`*^9, 
   3.606132957797183*^9}, 3.606133000300522*^9, 3.606134989090198*^9, 
   3.6063341922007437`*^9, 3.606334426800288*^9, 3.606334960092173*^9, 
   3.606335118457068*^9, 3.606335403514579*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Check", " ", "that", " ", "gains", " ", "with", " ", "original", " ", 
     "eigenvalues", " ", "are", " ", "0"}], ",", " ", 
    RowBox[{"as", " ", "expected"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"{", 
      RowBox[{"s1", ",", "s2", ",", "s3", ",", "s4"}], "}"}], "=", 
     RowBox[{"Eigenvalues", "[", "A", "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"Chop", "[", "zgains", "]"}]}]}]], "Input",
 CellChangeTimes->{{3.606056388444345*^9, 3.6060563896177883`*^9}, {
  3.606134967890007*^9, 3.6061349834642887`*^9}, {3.6063341952600203`*^9, 
  3.606334196596094*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{"0", ",", "0", ",", "0", ",", "0"}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056390077888*^9, 3.6060608440606194`*^9, 3.606061197904313*^9, 
   3.606062398183969*^9, 3.6060647666479673`*^9, 3.606065237791548*^9, {
   3.606065276531499*^9, 3.60606530270059*^9}, 3.6060664435920477`*^9, 
   3.606082603837182*^9, 3.606082635914302*^9, 3.606082674797896*^9, 
   3.6060831513069696`*^9, {3.606083209930477*^9, 3.6060832255752697`*^9}, {
   3.606083272031111*^9, 3.606083292333119*^9}, {3.6060834125258703`*^9, 
   3.606083425391591*^9}, {3.6060834742436523`*^9, 3.60608352745761*^9}, 
   3.606083687602775*^9, 3.6060838347343597`*^9, {3.606132915213293*^9, 
   3.6061329578460817`*^9}, 3.606133000379428*^9, 3.606134989140956*^9, 
   3.606334197096931*^9, 3.6063344268471327`*^9, 3.606334960177875*^9, 
   3.606335118554871*^9, 3.60633540358208*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Clear", "[", 
  RowBox[{"s1", ",", "s2", ",", "s3", ",", "s4"}], 
  "]"}], "\[IndentingNewLine]", "zgains", "\[IndentingNewLine]", 
 RowBox[{"xgains", "=", 
  RowBox[{"(", 
   RowBox[{"zgains", ".", "T"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.606056395548769*^9, 3.606056395745246*^9}, {
  3.606334200269911*^9, 3.606334201219692*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"1.`", " ", "s1", " ", "s2", " ", "s3", " ", "s4"}], "+", 
     "0.`"}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"s1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"s2", " ", 
          RowBox[{"(", 
           RowBox[{"s3", "+", "s4"}], ")"}]}], "+", 
         RowBox[{"s3", " ", "s4"}]}], ")"}]}]}], "-", 
     RowBox[{"s2", " ", "s3", " ", "s4"}]}], ",", 
    RowBox[{
     RowBox[{"1.`", " ", "s1", " ", 
      RowBox[{"(", 
       RowBox[{"s2", "+", "s3", "+", "s4"}], ")"}]}], "+", 
     RowBox[{"1.`", " ", "s2", " ", 
      RowBox[{"(", 
       RowBox[{"s3", "+", "s4"}], ")"}]}], "+", 
     RowBox[{"1.`", " ", "s3", " ", "s4"}], "+", "7.3575`"}], ",", 
    RowBox[{
     RowBox[{"-", "s1"}], "-", "s2", "-", "s3", "-", "s4"}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056396257104*^9, 3.606060844108624*^9, 3.606061199116514*^9, 
   3.6060623982303143`*^9, 3.606064766714116*^9, 3.606065237843292*^9, {
   3.606065276579794*^9, 3.6060653027503023`*^9}, 3.6060664437538557`*^9, 
   3.606082603909298*^9, 3.606082635976097*^9, 3.606082674866502*^9, 
   3.6060831513899717`*^9, {3.606083209980781*^9, 3.606083225664666*^9}, {
   3.6060832721048603`*^9, 3.606083292399869*^9}, {3.606083412594057*^9, 
   3.606083425450534*^9}, {3.60608347429377*^9, 3.606083527539073*^9}, 
   3.606083687653627*^9, 3.606083834799674*^9, {3.6061329152689257`*^9, 
   3.606132958041628*^9}, 3.606133000428563*^9, 3.606134989198151*^9, 
   3.606334201982573*^9, 3.6063344270084267`*^9, 3.606334960226531*^9, 
   3.606335118617597*^9, 3.606335403656877*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"0.`", "\[VeryThinSpace]", "-", 
     RowBox[{"20.387359836901123`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1.`", " ", "s1", " ", "s2", " ", "s3", " ", "s4"}], "+", 
        "0.`"}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"40.774719673802245`", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"1.`", " ", "s1", " ", "s2", " ", "s3", " ", "s4"}], "+", 
         "0.`"}], ")"}]}]}], "-", 
     RowBox[{"200.`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"1.`", " ", "s1", " ", 
         RowBox[{"(", 
          RowBox[{"s2", "+", "s3", "+", "s4"}], ")"}]}], "+", 
        RowBox[{"1.`", " ", "s2", " ", 
         RowBox[{"(", 
          RowBox[{"s3", "+", "s4"}], ")"}]}], "+", 
        RowBox[{"1.`", " ", "s3", " ", "s4"}], "+", "7.3575`"}], ")"}]}], "+",
      "0.`"}], ",", 
    RowBox[{"0.`", "\[VeryThinSpace]", "-", 
     RowBox[{"20.387359836901123`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"s1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s2", " ", 
             RowBox[{"(", 
              RowBox[{"s3", "+", "s4"}], ")"}]}], "+", 
            RowBox[{"s3", " ", "s4"}]}], ")"}]}]}], "-", 
        RowBox[{"s2", " ", "s3", " ", "s4"}]}], ")"}]}]}], ",", 
    RowBox[{
     RowBox[{"-", 
      RowBox[{"200.`", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "s1"}], "-", "s2", "-", "s3", "-", "s4"}], ")"}]}]}], 
     "-", 
     RowBox[{"40.774719673802245`", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         RowBox[{"s1", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"s2", " ", 
             RowBox[{"(", 
              RowBox[{"s3", "+", "s4"}], ")"}]}], "+", 
            RowBox[{"s3", " ", "s4"}]}], ")"}]}]}], "-", 
        RowBox[{"s2", " ", "s3", " ", "s4"}]}], ")"}]}], "+", "0.`"}]}], 
   "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056396257104*^9, 3.606060844108624*^9, 3.606061199116514*^9, 
   3.6060623982303143`*^9, 3.606064766714116*^9, 3.606065237843292*^9, {
   3.606065276579794*^9, 3.6060653027503023`*^9}, 3.6060664437538557`*^9, 
   3.606082603909298*^9, 3.606082635976097*^9, 3.606082674866502*^9, 
   3.6060831513899717`*^9, {3.606083209980781*^9, 3.606083225664666*^9}, {
   3.6060832721048603`*^9, 3.606083292399869*^9}, {3.606083412594057*^9, 
   3.606083425450534*^9}, {3.60608347429377*^9, 3.606083527539073*^9}, 
   3.606083687653627*^9, 3.606083834799674*^9, {3.6061329152689257`*^9, 
   3.606132958041628*^9}, 3.606133000428563*^9, 3.606134989198151*^9, 
   3.606334201982573*^9, 3.6063344270084267`*^9, 3.606334960226531*^9, 
   3.606335118617597*^9, 3.606335403731986*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Assume", " ", "all", " ", "poles", " ", "are", " ", "Butterworth", " ", 
    "Poles"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"s1", ",", "s2", ",", "s3", ",", "s4"}], "}"}], "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "0.5877852522924731`"}], "+", 
       RowBox[{"I", " ", "0.8090169943749475`"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.9510565162951535`"}], "+", 
       RowBox[{"I", " ", "0.30901699437494745`"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.9510565162951535`"}], " ", "-", 
       RowBox[{"I", " ", "0.30901699437494745`"}]}], ",", 
      RowBox[{
       RowBox[{"-", "0.5877852522924731`"}], "-", 
       RowBox[{"I", " ", "0.8090169943749475`"}]}]}], "}"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.606056403444214*^9, 3.606056405578309*^9}, {
   3.6060652068630037`*^9, 3.606065208430176*^9}, {3.606065268230301*^9, 
   3.606065296196617*^9}, {3.606082596395609*^9, 3.606082628022539*^9}, {
   3.606082662821918*^9, 3.606082667357637*^9}, {3.60613495514589*^9, 
   3.606134962288671*^9}, {3.606334205501029*^9, 3.606334214147738*^9}, 
   3.60633433666145*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Chop", "[", "zgains", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Chop", "[", "xgains", "]"}]}], "Input",
 CellChangeTimes->{{3.606334348228133*^9, 3.606334371239538*^9}, {
  3.606334418368392*^9, 3.6063344203906307`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
   "1.`", ",", "3.077683537175253`", ",", "11.59356797749979`", ",", 
    "3.077683537175253`"}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606056411050928*^9, 3.606060844205995*^9, 3.6060612020579357`*^9, 
   3.60606239832861*^9, 3.606064766826394*^9, 3.60606523793812*^9, {
   3.606065276680193*^9, 3.606065302848763*^9}, 3.6060664441312103`*^9, 
   3.606082604005377*^9, 3.6060826360769*^9, 3.6060826749691887`*^9, 
   3.606083151492002*^9, {3.606083210094211*^9, 3.6060832257641897`*^9}, {
   3.606083272204777*^9, 3.606083292545085*^9}, {3.606083412705011*^9, 
   3.6060834255698433`*^9}, {3.606083474413066*^9, 3.606083527692177*^9}, 
   3.606083687780767*^9, 3.6060838349335012`*^9, {3.606132915362508*^9, 
   3.6061329581907473`*^9}, 3.606133000558929*^9, 3.606134989299354*^9, {
   3.606334340797596*^9, 3.606334371746426*^9}, 3.606334427214522*^9, 
   3.606334960553961*^9, 3.606335118952533*^9, 3.606335403810845*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"-", "20.387359836901123`"}], ",", 
    RowBox[{"-", "2359.4883151737604`"}], ",", 
    RowBox[{"-", "62.74584173649854`"}], ",", 
    RowBox[{"-", "741.0283909080478`"}]}], "}"}], TraditionalForm]], "Output",\

 CellChangeTimes->{
  3.606056411050928*^9, 3.606060844205995*^9, 3.6060612020579357`*^9, 
   3.60606239832861*^9, 3.606064766826394*^9, 3.60606523793812*^9, {
   3.606065276680193*^9, 3.606065302848763*^9}, 3.6060664441312103`*^9, 
   3.606082604005377*^9, 3.6060826360769*^9, 3.6060826749691887`*^9, 
   3.606083151492002*^9, {3.606083210094211*^9, 3.6060832257641897`*^9}, {
   3.606083272204777*^9, 3.606083292545085*^9}, {3.606083412705011*^9, 
   3.6060834255698433`*^9}, {3.606083474413066*^9, 3.606083527692177*^9}, 
   3.606083687780767*^9, 3.6060838349335012`*^9, {3.606132915362508*^9, 
   3.6061329581907473`*^9}, 3.606133000558929*^9, 3.606134989299354*^9, {
   3.606334340797596*^9, 3.606334371746426*^9}, 3.606334427214522*^9, 
   3.606334960553961*^9, 3.606335118952533*^9, 3.606335403816177*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", " ", 
  RowBox[{
   RowBox[{"Choose", " ", "state", " ", "vector"}], " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"\[Theta]", ",", " ", "\[Theta]t"}], "}"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.606060802602228*^9, 3.6060608126948357`*^9}, {
  3.606134938443014*^9, 3.6061349387130823`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"X", " ", "=", " ", 
  RowBox[{"Array", "[", 
   RowBox[{"x", ",", "4"}], "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x1t", " ", "=", " ", 
   RowBox[{"x", "[", "3", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x2t", " ", "=", " ", 
   RowBox[{"x", "[", "4", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x3t", "=", 
   RowBox[{"ytt", " ", "/.", "parameters"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"x4t", " ", "=", " ", 
   RowBox[{"\[Theta]tt", "/.", "parameters"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Theta]", "=", 
   RowBox[{"x", "[", "2", "]"}]}], ";", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"y", "'"}], "[", "t", "]"}], " ", "=", 
   RowBox[{"x", "[", "3", "]"}]}], ";", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]", "'"}], "[", "t", "]"}], "=", 
   RowBox[{"x", "[", "4", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"xt", " ", "=", " ", 
  RowBox[{"{", 
   RowBox[{"x1t", ",", "x2t", ",", "x3t", ",", "x4t"}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.606060140508233*^9, 3.606060196172099*^9}, {
   3.6060604088715487`*^9, 3.6060604684241743`*^9}, {3.60606049894341*^9, 
   3.606060499310417*^9}, {3.6060605875651693`*^9, 3.606060590754992*^9}, 
   3.606060670005217*^9, {3.606060987503448*^9, 3.606060998795788*^9}, {
   3.606061209274084*^9, 3.6060612114210787`*^9}, {3.606334377364512*^9, 
   3.606334377465119*^9}, {3.6063345029513483`*^9, 3.60633455130159*^9}, {
   3.606335373746749*^9, 3.606335377450054*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "(", "1", ")"}], ",", 
    RowBox[{"x", "(", "2", ")"}], ",", 
    RowBox[{"x", "(", "3", ")"}], ",", 
    RowBox[{"x", "(", "4", ")"}]}], "}"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606060469190898*^9, 3.606060500199882*^9, 3.606060610108992*^9, {
   3.606060642952249*^9, 3.606060671468801*^9}, {3.606060753092339*^9, 
   3.606060755657111*^9}, 3.606060844579582*^9, 3.6060609991010723`*^9, 
   3.6060612183582277`*^9, 3.606062398554178*^9, 3.606064767052484*^9, 
   3.606065238163097*^9, {3.606065276936345*^9, 3.6060653030740147`*^9}, 
   3.606066445341365*^9, 3.60608260407911*^9, 3.606082636173074*^9, 
   3.606082675055092*^9, 3.606083151579823*^9, {3.60608321018676*^9, 
   3.606083225850072*^9}, {3.6060832722760468`*^9, 3.606083292634006*^9}, {
   3.60608341278237*^9, 3.606083425643848*^9}, {3.6060834745158567`*^9, 
   3.606083527795336*^9}, 3.60608368787436*^9, 3.606083835073228*^9, {
   3.606132915626033*^9, 3.606132958454073*^9}, 3.606133000841844*^9, 
   3.6061349893753157`*^9, 3.606334427311833*^9, 3.606334960630686*^9, 
   3.6063351190450583`*^9, {3.60633537782164*^9, 3.606335403910267*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x", "(", "3", ")"}], ",", 
    RowBox[{"x", "(", "4", ")"}], ",", 
    RowBox[{
     FractionBox["1", "150"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", 
        RowBox[{"100", " ", 
         RowBox[{
          SuperscriptBox[
           RowBox[{"x", "(", "2", ")"}], "\[Prime]\[Prime]",
           MultilineFunction->None], "\[InvisibleApplication]", 
          RowBox[{"(", "t", ")"}]}], " ", 
         RowBox[{"cos", "(", 
          RowBox[{
           RowBox[{"x", "(", "2", ")"}], "\[InvisibleApplication]", 
           RowBox[{"(", "t", ")"}]}], ")"}]}]}], "+", 
       RowBox[{"100", " ", 
        SuperscriptBox[
         RowBox[{"x", "(", "4", ")"}], "2"], " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          RowBox[{"x", "(", "2", ")"}], "\[InvisibleApplication]", 
          RowBox[{"(", "t", ")"}]}], ")"}]}], "+", "f"}], ")"}]}], ",", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"9.81`", " ", 
        RowBox[{"sin", "(", 
         RowBox[{
          RowBox[{"x", "(", "2", ")"}], "\[InvisibleApplication]", 
          RowBox[{"(", "t", ")"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{
         SuperscriptBox["y", "\[Prime]\[Prime]",
          MultilineFunction->None], "(", "t", ")"}], " ", 
        RowBox[{"cos", "(", 
         RowBox[{
          RowBox[{"x", "(", "2", ")"}], "\[InvisibleApplication]", 
          RowBox[{"(", "t", ")"}]}], ")"}]}]}], ")"}]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606060469190898*^9, 3.606060500199882*^9, 3.606060610108992*^9, {
   3.606060642952249*^9, 3.606060671468801*^9}, {3.606060753092339*^9, 
   3.606060755657111*^9}, 3.606060844579582*^9, 3.6060609991010723`*^9, 
   3.6060612183582277`*^9, 3.606062398554178*^9, 3.606064767052484*^9, 
   3.606065238163097*^9, {3.606065276936345*^9, 3.6060653030740147`*^9}, 
   3.606066445341365*^9, 3.60608260407911*^9, 3.606082636173074*^9, 
   3.606082675055092*^9, 3.606083151579823*^9, {3.60608321018676*^9, 
   3.606083225850072*^9}, {3.6060832722760468`*^9, 3.606083292634006*^9}, {
   3.60608341278237*^9, 3.606083425643848*^9}, {3.6060834745158567`*^9, 
   3.606083527795336*^9}, 3.60608368787436*^9, 3.606083835073228*^9, {
   3.606132915626033*^9, 3.606132958454073*^9}, 3.606133000841844*^9, 
   3.6061349893753157`*^9, 3.606334427311833*^9, 3.606334960630686*^9, 
   3.6063351190450583`*^9, {3.60633537782164*^9, 3.6063354039445543`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xdot", " ", "=", " ", 
  RowBox[{"xt", " ", "/.", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"x", "[", "2", "]"}], "\[Rule]", "x2"}], ",", 
     RowBox[{
      RowBox[{
       RowBox[{"x", "[", "1", "]"}], "[", "t", "]"}], "\[Rule]", 
      RowBox[{"x1", "[", "t", "]"}]}], ",", 
     RowBox[{
      RowBox[{"x", "[", "3", "]"}], "\[Rule]", 
      RowBox[{"x3", "[", "t", "]"}]}], ",", 
     RowBox[{
      RowBox[{"x", "[", "4", "]"}], "\[Rule]", 
      RowBox[{"x4", "[", "t", "]"}]}]}], "}"}]}]}]], "Input",
 CellChangeTimes->{{3.606060489946601*^9, 3.606060517309094*^9}, {
  3.60606076689684*^9, 3.606060772568625*^9}, {3.606061934079688*^9, 
  3.60606196117344*^9}, {3.6060619945757627`*^9, 3.606062023893126*^9}, {
  3.6063345692549477`*^9, 3.606334569628847*^9}, {3.6063350444450808`*^9, 
  3.606335044939292*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{"x3", "(", "t", ")"}], ",", 
    RowBox[{"x4", "(", "t", ")"}], ",", 
    RowBox[{
     FractionBox["1", "150"], " ", 
     RowBox[{"(", 
      RowBox[{"f", "-", 
       RowBox[{"100", " ", 
        RowBox[{
         SuperscriptBox["x2", "\[Prime]\[Prime]",
          MultilineFunction->None], "(", "t", ")"}], " ", 
        RowBox[{"cos", "(", 
         RowBox[{"x2", "(", "t", ")"}], ")"}]}], "+", 
       RowBox[{"100", " ", 
        SuperscriptBox[
         RowBox[{"x4", "(", "t", ")"}], "2"], " ", 
        RowBox[{"sin", "(", 
         RowBox[{"x2", "(", "t", ")"}], ")"}]}]}], ")"}]}], ",", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"9.81`", " ", 
        RowBox[{"sin", "(", 
         RowBox[{"x2", "(", "t", ")"}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"cos", "(", 
         RowBox[{"x2", "(", "t", ")"}], ")"}], " ", 
        RowBox[{
         SuperscriptBox["y", "\[Prime]\[Prime]",
          MultilineFunction->None], "(", "t", ")"}]}]}], ")"}]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.6060605178510227`*^9, 3.606060688272468*^9, {3.6060607682595673`*^9, 
   3.606060773229401*^9}, 3.606060844648714*^9, 3.606061010045021*^9, 
   3.60606123621567*^9, {3.606061934599872*^9, 3.606061961615427*^9}, 
   3.6060620249626617`*^9, 3.606062398623465*^9, 3.60606476712505*^9, 
   3.606065238232606*^9, {3.606065277008231*^9, 3.60606530314358*^9}, 
   3.606066445606557*^9, 3.606082604140177*^9, 3.606082636221085*^9, 
   3.6060826751243877`*^9, 3.6060831516540956`*^9, {3.606083210240675*^9, 
   3.6060832259005003`*^9}, {3.606083272325725*^9, 3.606083292899436*^9}, {
   3.606083412836315*^9, 3.606083425699883*^9}, {3.606083474591648*^9, 
   3.606083527848898*^9}, 3.6060836879453*^9, 3.6060838351380787`*^9, {
   3.6061329156728077`*^9, 3.606132958549396*^9}, 3.606133000935854*^9, 
   3.606134989426075*^9, 3.606334427529677*^9, 3.6063349607184362`*^9, 
   3.606335049358878*^9, 3.606335119153776*^9, {3.606335381836075*^9, 
   3.606335404128291*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Generic", " ", "differential", " ", "equations"}], ",", " ", 
    "nonlinear"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ode1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"x1", "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{"xdot", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"ode2", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"x2", "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{"xdot", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"ode3", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"x3", "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{"xdot", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"ode4", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"x4", "'"}], "[", "t", "]"}], "\[Equal]", 
     RowBox[{"xdot", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.606134911893228*^9, 3.606134920305936*^9}, {
  3.606334577997357*^9, 3.60633457813736*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["x1", "\[Prime]",
     MultilineFunction->None], "(", "t", ")"}], "\[LongEqual]", 
   RowBox[{"x3", "(", "t", ")"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606060529493883*^9, 3.606060690795003*^9, 3.6060608446998463`*^9, 
   3.6060610124556704`*^9, 3.606061238345912*^9, {3.60606194028894*^9, 
   3.606061967290646*^9}, 3.606062027347568*^9, 3.606062398675332*^9, 
   3.6060647671867523`*^9, 3.6060652382819643`*^9, {3.606065277203602*^9, 
   3.606065303193035*^9}, 3.606066445717739*^9, 3.606082604202009*^9, 
   3.6060826362897663`*^9, 3.60608267517397*^9, 3.60608315183469*^9, {
   3.606083210285141*^9, 3.606083225944495*^9}, {3.6060832723678102`*^9, 
   3.60608329294831*^9}, {3.606083412900346*^9, 3.606083425748794*^9}, {
   3.6060834746364717`*^9, 3.606083528039423*^9}, 3.60608368800991*^9, 
   3.606083835190934*^9, {3.606132915732273*^9, 3.606132958599168*^9}, 
   3.606133000984239*^9, 3.606134989480085*^9, 3.606334427583095*^9, 
   3.606334960782917*^9, 3.6063350670958147`*^9, 3.6063351192232637`*^9, {
   3.606335384318346*^9, 3.6063354043693438`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["x2", "\[Prime]",
     MultilineFunction->None], "(", "t", ")"}], "\[LongEqual]", 
   RowBox[{"x4", "(", "t", ")"}]}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606060529493883*^9, 3.606060690795003*^9, 3.6060608446998463`*^9, 
   3.6060610124556704`*^9, 3.606061238345912*^9, {3.60606194028894*^9, 
   3.606061967290646*^9}, 3.606062027347568*^9, 3.606062398675332*^9, 
   3.6060647671867523`*^9, 3.6060652382819643`*^9, {3.606065277203602*^9, 
   3.606065303193035*^9}, 3.606066445717739*^9, 3.606082604202009*^9, 
   3.6060826362897663`*^9, 3.60608267517397*^9, 3.60608315183469*^9, {
   3.606083210285141*^9, 3.606083225944495*^9}, {3.6060832723678102`*^9, 
   3.60608329294831*^9}, {3.606083412900346*^9, 3.606083425748794*^9}, {
   3.6060834746364717`*^9, 3.606083528039423*^9}, 3.60608368800991*^9, 
   3.606083835190934*^9, {3.606132915732273*^9, 3.606132958599168*^9}, 
   3.606133000984239*^9, 3.606134989480085*^9, 3.606334427583095*^9, 
   3.606334960782917*^9, 3.6063350670958147`*^9, 3.6063351192232637`*^9, {
   3.606335384318346*^9, 3.606335404373901*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["x3", "\[Prime]",
     MultilineFunction->None], "(", "t", ")"}], "\[LongEqual]", 
   RowBox[{
    FractionBox["1", "150"], " ", 
    RowBox[{"(", 
     RowBox[{"f", "-", 
      RowBox[{"100", " ", 
       RowBox[{
        SuperscriptBox["x2", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], " ", 
       RowBox[{"cos", "(", 
        RowBox[{"x2", "(", "t", ")"}], ")"}]}], "+", 
      RowBox[{"100", " ", 
       SuperscriptBox[
        RowBox[{"x4", "(", "t", ")"}], "2"], " ", 
       RowBox[{"sin", "(", 
        RowBox[{"x2", "(", "t", ")"}], ")"}]}]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606060529493883*^9, 3.606060690795003*^9, 3.6060608446998463`*^9, 
   3.6060610124556704`*^9, 3.606061238345912*^9, {3.60606194028894*^9, 
   3.606061967290646*^9}, 3.606062027347568*^9, 3.606062398675332*^9, 
   3.6060647671867523`*^9, 3.6060652382819643`*^9, {3.606065277203602*^9, 
   3.606065303193035*^9}, 3.606066445717739*^9, 3.606082604202009*^9, 
   3.6060826362897663`*^9, 3.60608267517397*^9, 3.60608315183469*^9, {
   3.606083210285141*^9, 3.606083225944495*^9}, {3.6060832723678102`*^9, 
   3.60608329294831*^9}, {3.606083412900346*^9, 3.606083425748794*^9}, {
   3.6060834746364717`*^9, 3.606083528039423*^9}, 3.60608368800991*^9, 
   3.606083835190934*^9, {3.606132915732273*^9, 3.606132958599168*^9}, 
   3.606133000984239*^9, 3.606134989480085*^9, 3.606334427583095*^9, 
   3.606334960782917*^9, 3.6063350670958147`*^9, 3.6063351192232637`*^9, {
   3.606335384318346*^9, 3.606335404385873*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["x4", "\[Prime]",
     MultilineFunction->None], "(", "t", ")"}], "\[LongEqual]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"9.81`", " ", 
       RowBox[{"sin", "(", 
        RowBox[{"x2", "(", "t", ")"}], ")"}]}], "-", 
      RowBox[{
       RowBox[{"cos", "(", 
        RowBox[{"x2", "(", "t", ")"}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["y", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}]}]}], ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606060529493883*^9, 3.606060690795003*^9, 3.6060608446998463`*^9, 
   3.6060610124556704`*^9, 3.606061238345912*^9, {3.60606194028894*^9, 
   3.606061967290646*^9}, 3.606062027347568*^9, 3.606062398675332*^9, 
   3.6060647671867523`*^9, 3.6060652382819643`*^9, {3.606065277203602*^9, 
   3.606065303193035*^9}, 3.606066445717739*^9, 3.606082604202009*^9, 
   3.6060826362897663`*^9, 3.60608267517397*^9, 3.60608315183469*^9, {
   3.606083210285141*^9, 3.606083225944495*^9}, {3.6060832723678102`*^9, 
   3.60608329294831*^9}, {3.606083412900346*^9, 3.606083425748794*^9}, {
   3.6060834746364717`*^9, 3.606083528039423*^9}, 3.60608368800991*^9, 
   3.606083835190934*^9, {3.606132915732273*^9, 3.606132958599168*^9}, 
   3.606133000984239*^9, 3.606134989480085*^9, 3.606334427583095*^9, 
   3.606334960782917*^9, 3.6063350670958147`*^9, 3.6063351192232637`*^9, {
   3.606335384318346*^9, 3.6063354043904333`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Assume", " ", "simple", " ", "parameters"}], ",", " ", 
    RowBox[{"set", " ", "up", " ", "differential", " ", "equations"}]}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"nodes", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"ode1", " ", "/.", "parameters"}], ",", 
     RowBox[{"ode2", " ", "/.", "parameters"}], ",", " ", 
     RowBox[{"ode2", "/.", "parameters"}], ",", 
     RowBox[{"ode4", " ", "/.", "parameters"}]}], " ", "}"}]}]}]], "Input",
 CellChangeTimes->{{3.606057568163575*^9, 3.606057591735724*^9}, {
  3.606057644280609*^9, 3.6060576578013363`*^9}, {3.606060545789731*^9, 
  3.606060545981271*^9}, {3.6060612643748283`*^9, 3.606061271941895*^9}, {
  3.606062577316309*^9, 3.606062579281456*^9}, {3.606134891341867*^9, 
  3.606134909034451*^9}, {3.6063345860882263`*^9, 3.606334596311445*^9}, {
  3.606334753922385*^9, 3.606334774387726*^9}, {3.606334903870009*^9, 
  3.606334929659931*^9}, {3.606335077098484*^9, 3.606335090313477*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      SuperscriptBox["x1", "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[LongEqual]", 
     RowBox[{"x3", "(", "t", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x2", "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[LongEqual]", 
     RowBox[{"x4", "(", "t", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x2", "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[LongEqual]", 
     RowBox[{"x4", "(", "t", ")"}]}], ",", 
    RowBox[{
     RowBox[{
      SuperscriptBox["x4", "\[Prime]",
       MultilineFunction->None], "(", "t", ")"}], "\[LongEqual]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"9.81`", " ", 
         RowBox[{"sin", "(", 
          RowBox[{"x2", "(", "t", ")"}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"cos", "(", 
          RowBox[{"x2", "(", "t", ")"}], ")"}], " ", 
         RowBox[{
          SuperscriptBox["y", "\[Prime]\[Prime]",
           MultilineFunction->None], "(", "t", ")"}]}]}], ")"}]}]}]}], "}"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606057573988532*^9, 3.60605765812558*^9, 3.606060546344119*^9, 
   3.606060694262617*^9, 3.606060844875599*^9, {3.606061249052238*^9, 
   3.606061272249049*^9}, 3.606061691104869*^9, {3.60606194215123*^9, 
   3.6060619688620987`*^9}, 3.606062029176671*^9, 3.606062398722527*^9, 
   3.60606258071868*^9, 3.60606476724723*^9, 3.606065238329837*^9, {
   3.6060652772560997`*^9, 3.606065303240801*^9}, 3.606066445834553*^9, 
   3.606082604267721*^9, 3.6060826363399*^9, 3.606082675345549*^9, 
   3.60608315201462*^9, {3.606083210463627*^9, 3.6060832259934196`*^9}, {
   3.606083272417598*^9, 3.606083293018358*^9}, {3.6060834129707823`*^9, 
   3.606083425798828*^9}, {3.6060834747219667`*^9, 3.6060835280899763`*^9}, 
   3.606083688074575*^9, 3.606083835256248*^9, {3.6061329157736464`*^9, 
   3.606132958664798*^9}, 3.606133001033801*^9, 3.606134989528491*^9, 
   3.606334427644618*^9, 3.606334960848918*^9, {3.6063350731442327`*^9, 
   3.606335119294794*^9}, 3.606335404468728*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Initial", " ", "conditions"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ics", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"x1", "[", "0", "]"}], "\[Equal]", "y0"}], ",", " ", 
      RowBox[{
       RowBox[{"x2", "[", "0", "]"}], "\[Equal]", "\[Theta]0"}], ",", " ", 
      RowBox[{
       RowBox[{"x3", "[", "0", "]"}], "\[Equal]", "v0"}], ",", " ", 
      RowBox[{
       RowBox[{"x4", "[", "0", "]"}], "\[Equal]", "\[Omega]0"}]}], "}"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.606056905097599*^9, 3.60605690540753*^9}, {
   3.6060613110756702`*^9, 3.6060613411396637`*^9}, 3.606066700663871*^9, {
   3.606134867395602*^9, 3.6061348767286463`*^9}, {3.60633479309138*^9, 
   3.6063348103852577`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Our", " ", "\"\<answer\>\""}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"ans", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"x1", "[", "t", "]"}], ",", 
      RowBox[{"x2", "[", "t", "]"}], ",", 
      RowBox[{"x3", "[", "t", "]"}], ",", 
      RowBox[{"x4", "[", "t", "]"}]}], "}"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.60605692278047*^9, 3.606056929655108*^9}, 
   3.606066696431993*^9, {3.606134880242103*^9, 3.606134885882526*^9}, {
   3.60633481364163*^9, 3.60633481585443*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
    "Equilibrium", " ", "maintained", " ", "at", " ", "\[Pi]", " ", 
     "offset"}], ",", " ", 
    RowBox[{"being", " ", "an", " ", "inverted", " ", 
     RowBox[{"pendulum", "."}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"f", " ", "=", " ", "0"}], ";"}], " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"y0", "=", 
     RowBox[{"-", "5"}]}], ";", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Pi]", "/", "10"}]}], ";", 
    RowBox[{"v0", "=", "3"}], ";", 
    RowBox[{"\[Omega]0", "=", "\[Pi]"}], ";", 
    RowBox[{"tf", "=", "40"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"soln", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nodes", ",", "ics"}], "}"}], ",", "ans", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tf"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ny", "=", 
     RowBox[{"soln", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[Theta]", "=", 
     RowBox[{"soln", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nv", "=", 
     RowBox[{"soln", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "3", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[Omega]", "=", 
     RowBox[{"soln", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"NonlinearPicture", " ", "=", " ", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ny", ",", "n\[Theta]", ",", "nv", ",", "n\[Omega]"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "40"}], "}"}], ",", " ", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Blue", ",", "Green", ",", "Yellow"}], "}"}]}], 
      ",", 
      RowBox[{
      "PlotLabel", "\[Rule]", 
       "\"\<Motion of the Overhead Crane\\nred = position, blue = angle, \
green = speed, yellow = angular speed\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"f", ",", "y0", ",", "v0", ",", "\[Theta]0", ",", "\[Omega]0"}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->CompressedData["
1:eJxTTMoPSmViYGAQBmIQ7bFFLYLp3itHKX89MB0aU6fCAqR/zl+gAaJPCZs0
geilBjt7QLRY2fyVILpsmsEqEO00JWk9iH4yV2MDiD4SeX4LiFZh2rQVRBcs
mbgTRKdc37QLRCesXH0ARN/5+PQgiNbi+3kOROc95zwPomP4+0/wAem77yaD
6S9sSedA9Ks9lpdA9IeXuz+DaLuES99B9IrEp9z8QNrV/SWY3rgpiFUDSItc
38MJotl/L13bCaRv+ursANENfD17QDSLl9IBEP36P+MFEH3pHcN1EK12dPlj
EG1qIvsURItrh/wD0T8u3mfsAtIAVkml5w==
  "]],

Cell[BoxData[
 FormBox[
  GraphicsBox[{},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->True,
   AxesLabel->{None, None},
   AxesOrigin->{0, 0},
   Method->{},
   PlotLabel->FormBox[
    "\"Motion of the Overhead Crane\\nred = position, blue = angle, green = \
speed, yellow = angular speed\"", TraditionalForm],
   PlotRange->{All, All},
   PlotRangeClipping->True,
   PlotRangePadding->{Automatic, Automatic}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.606062184670179*^9, 3.606062192564352*^9}, {
   3.606062398917354*^9, 3.606062418106703*^9}, {3.60606246092537*^9, 
   3.606062465591651*^9}, {3.606062512777355*^9, 3.606062515124173*^9}, 
   3.606062551547925*^9, {3.6060625860328093`*^9, 3.606062607728054*^9}, 
   3.606062748350148*^9, 3.606064767677112*^9, 3.6060652387247553`*^9, {
   3.606065277515213*^9, 3.6060653036363*^9}, 3.606066446961597*^9, 
   3.6060826046161833`*^9, 3.606082636570602*^9, 3.6060826755835257`*^9, {
   3.60608314245395*^9, 3.60608315218913*^9}, {3.606083188809057*^9, 
   3.606083226336362*^9}, {3.606083272646627*^9, 3.606083293240438*^9}, {
   3.6060834131996393`*^9, 3.606083426006321*^9}, {3.606083474944375*^9, 
   3.60608352831454*^9}, {3.606083681074007*^9, 3.606083688312068*^9}, 
   3.6060838355192213`*^9, {3.60613291639861*^9, 3.606132958780854*^9}, 
   3.6061330012830276`*^9, 3.6061349896629467`*^9, 3.6063344280371428`*^9, {
   3.606334960957902*^9, 3.606334979597324*^9}, {3.6063350979885197`*^9, 
   3.6063351609093733`*^9}, {3.606335264179605*^9, 3.60633527378369*^9}, 
   3.606335404607492*^9, {3.606335468093742*^9, 3.606335503291744*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Oscillatory", " ", "motion", " ", "with", " ", "a", " ", 
    RowBox[{"\[Pi]", "/", "2"}], " ", "offset"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Pi]", "/", "2"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"\[Omega]0", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tf", " ", "=", " ", "100"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"soln", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nodes", ",", "ics"}], "}"}], ",", "ans", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tf"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[Theta]", "=", 
     RowBox[{"soln", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[Omega]", "=", 
     RowBox[{"soln", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"NonlinearPicture", " ", "=", " ", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"n\[Theta]", ",", "n\[Omega]"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "10"}], "}"}], ",", " ", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Blue"}], "}"}]}], ",", 
      RowBox[{
      "PlotLabel", "\[Rule]", 
       "\"\<Motion of \[Tau]-driven Inverted Pendulum\\nred = \[Theta], blue \
= \[Omega]\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"\[Theta]0", ",", "\[Omega]0"}], "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.606083828840803*^9, 3.60608382893515*^9}, {
  3.6061348079032907`*^9, 3.606134822486663*^9}}],

Cell[BoxData[
 FormBox[
  GraphicsBox[{},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->True,
   AxesLabel->{None, None},
   AxesOrigin->{0, 0},
   Method->{},
   PlotLabel->FormBox[
    "\"Motion of \[Tau]-driven Inverted Pendulum\\nred = \[Theta], blue = \
\[Omega]\"", TraditionalForm],
   PlotRange->{All, All},
   PlotRangeClipping->True,
   PlotRangePadding->{Automatic, Automatic}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.6060838294657784`*^9, 3.606083835625268*^9}, {
   3.606132916658663*^9, 3.606132958892605*^9}, 3.606133001437886*^9, 
   3.606134989751536*^9, 3.6063344280955973`*^9, 3.606334961060155*^9, 
   3.6063351195001*^9, 3.606335328113885*^9, 3.6063354046521187`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Control", " ", "when", " ", "offset", " ", "from", " ", "equalibrium", 
    " ", "by", " ", "\[Pi]", " ", "radians"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"f", " ", "=", " ", 
      RowBox[{"-", 
       RowBox[{"Chop", "[", 
        RowBox[{"xgains", ".", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"x1", "[", "t", "]"}], ",", 
           RowBox[{"x2", "[", "t", "]"}], ",", 
           RowBox[{"x3", "[", "t", "]"}], ",", 
           RowBox[{"x4", "[", "t", "]"}]}], "}"}]}], "]"}]}]}], ";"}], ";"}], 
   " ", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"y0", "=", 
     RowBox[{"-", "5"}]}], ";", 
    RowBox[{"\[Theta]0", "=", 
     RowBox[{"\[Pi]", "/", "10"}]}], ";", 
    RowBox[{"v0", "=", "0"}], ";", 
    RowBox[{"\[Omega]0", "=", "0"}], ";", 
    RowBox[{"tf", "=", "40"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"soln", "=", 
     RowBox[{"NDSolve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"nodes", ",", "ics"}], "}"}], ",", "ans", ",", 
       RowBox[{"{", 
        RowBox[{"t", ",", "0", ",", "tf"}], "}"}]}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"ny", "=", 
     RowBox[{"soln", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "1", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[Theta]", "=", 
     RowBox[{"soln", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "2", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nv", "=", 
     RowBox[{"soln", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "3", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"n\[Omega]", "=", 
     RowBox[{"soln", "[", 
      RowBox[{"[", 
       RowBox[{"1", ",", "4", ",", "2"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"ControlledPicture", " ", "=", " ", 
    RowBox[{"Plot", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"ny", ",", "n\[Theta]", ",", "nv", ",", "n\[Omega]"}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"t", ",", "0", ",", "40"}], "}"}], ",", " ", 
      RowBox[{"PlotStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"Red", ",", "Blue", ",", "Green", ",", "Yellow"}], "}"}]}], 
      ",", 
      RowBox[{
      "PlotLabel", "\[Rule]", 
       "\"\<Motion of the Overhead Crane\\nred = position, blue = angle, \
green = speed, yellow = angular speed\>\""}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Clear", "[", 
     RowBox[{"f", ",", "y0", ",", "v0", ",", "\[Theta]0", ",", "\[Omega]0"}], 
     "]"}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.6060627963529453`*^9, 3.606062806694207*^9}, {
  3.606063027745595*^9, 3.606063030282646*^9}, {3.606063229435733*^9, 
  3.606063263854013*^9}, {3.6060633726196003`*^9, 3.606063439895344*^9}, {
  3.606063507861058*^9, 3.606063556914155*^9}, {3.6060636381606617`*^9, 
  3.606063638510436*^9}, {3.606064043501337*^9, 3.606064055776787*^9}, {
  3.6060642431215057`*^9, 3.606064270094399*^9}, {3.606064772888349*^9, 
  3.606064774284575*^9}, {3.606065146369131*^9, 3.606065146509769*^9}, {
  3.606066668456958*^9, 3.606066669867942*^9}, {3.606067176101795*^9, 
  3.606067178689087*^9}, {3.6060829776606503`*^9, 3.606082992011188*^9}, {
  3.6060832874623137`*^9, 3.6060833026281633`*^9}, {3.6060835070994253`*^9, 
  3.6060835112390203`*^9}, {3.606132907121497*^9, 3.606132963292901*^9}, {
  3.6061347884492197`*^9, 3.606134804297615*^9}, {3.606335297905908*^9, 
  3.6063353344284782`*^9}}],

Cell[BoxData[
 FormBox[
  GraphicsBox[{},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->True,
   AxesLabel->{None, None},
   AxesOrigin->{0, 0},
   Method->{},
   PlotLabel->FormBox[
    "\"Motion of the Overhead Crane\\nred = position, blue = angle, green = \
speed, yellow = angular speed\"", TraditionalForm],
   PlotRange->{All, All},
   PlotRangeClipping->True,
   PlotRangePadding->{Automatic, Automatic}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.606062820775626*^9, {3.606063214346789*^9, 3.606063251872711*^9}, 
   3.606063397572351*^9, 3.6060634411393557`*^9, {3.606063508437786*^9, 
   3.606063557457911*^9}, 3.606063639244898*^9, {3.606064044399638*^9, 
   3.606064056561348*^9}, {3.606064243644505*^9, 3.60606427054633*^9}, {
   3.606064767771113*^9, 3.606064774862393*^9}, 3.606065147281592*^9, 
   3.606065238802024*^9, {3.6060652775912848`*^9, 3.606065303713286*^9}, 
   3.606066447652701*^9, 3.606066671343712*^9, 3.606067179447091*^9, 
   3.6060826047201557`*^9, 3.606082636782056*^9, 3.606082675646351*^9, {
   3.606082983194195*^9, 3.606082992570135*^9}, 3.606083152293578*^9, {
   3.606083210646693*^9, 3.6060832264046926`*^9}, {3.6060832728547983`*^9, 
   3.606083293328409*^9}, {3.606083413404345*^9, 3.606083426197699*^9}, {
   3.606083475183463*^9, 3.6060835283844023`*^9}, 3.606083688406748*^9, 
   3.606083835708867*^9, {3.606132916734918*^9, 3.606132959112588*^9}, 
   3.6061330015547447`*^9, 3.6061349899884377`*^9, 3.606334428213518*^9, 
   3.606334961154211*^9, 3.606335119586569*^9, {3.606335316309698*^9, 
   3.606335335208787*^9}, 3.606335404797483*^9}]
}, Open  ]]
},
WindowSize->{640, 752},
WindowMargins->{{Automatic, 97}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "Applications", 
   "Mathematica.app", "SystemFiles", "FrontEnd", "StyleSheets", "Creative"}, 
  "NaturalColor.nb", CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 281, 6, 56, "Input"],
Cell[CellGroupData[{
Cell[863, 30, 3390, 84, 277, "Input"],
Cell[4256, 116, 2034, 44, 58, "Output"],
Cell[6293, 162, 1276, 21, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[7606, 188, 2179, 60, 107, "Input"],
Cell[9788, 250, 2250, 45, 43, "Output"],
Cell[12041, 297, 2110, 41, 45, "Output"],
Cell[14154, 340, 2098, 39, 61, "Output"],
Cell[16255, 381, 1886, 35, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18178, 421, 1166, 30, 56, "Input"],
Cell[19347, 453, 1539, 30, 41, "Output"],
Cell[20889, 485, 1593, 31, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[22519, 521, 876, 22, 56, "Input"],
Cell[23398, 545, 1722, 33, 41, "Output"],
Cell[25123, 580, 1802, 35, 45, "Output"]
}, Open  ]],
Cell[26940, 618, 322, 8, 38, "Input"],
Cell[CellGroupData[{
Cell[27287, 630, 3136, 83, 158, "Input"],
Cell[30426, 715, 593, 15, 58, "Output"],
Cell[31022, 732, 797, 22, 58, "Output"],
Cell[31822, 756, 379, 8, 55, "Output"],
Cell[32204, 766, 480, 12, 58, "Output"],
Cell[32687, 780, 335, 6, 58, "Output"],
Cell[33025, 788, 379, 8, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[33441, 801, 1713, 40, 124, "Input"],
Cell[35157, 843, 2009, 39, 90, "Output"],
Cell[37169, 884, 1994, 41, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[39200, 930, 858, 18, 56, "Input"],
Cell[40061, 950, 1882, 39, 110, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[41980, 994, 508, 13, 56, "Input"],
Cell[42491, 1009, 996, 15, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[43524, 1029, 897, 23, 73, "Input"],
Cell[44424, 1054, 442, 10, 38, "Output"],
Cell[44869, 1066, 1098, 28, 90, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46004, 1099, 284, 6, 56, "Input"],
Cell[46291, 1107, 1533, 31, 90, "Output"],
Cell[47827, 1140, 1447, 31, 90, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[49311, 1176, 1001, 30, 107, "Input"],
Cell[50315, 1208, 2191, 54, 90, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52543, 1267, 669, 17, 56, "Input"],
Cell[53215, 1286, 1580, 34, 90, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54832, 1325, 81, 2, 38, "Input"],
Cell[54916, 1329, 1803, 38, 90, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56756, 1372, 513, 14, 56, "Input"],
Cell[57272, 1388, 1411, 29, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58720, 1422, 498, 15, 38, "Input"],
Cell[59221, 1439, 1799, 45, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61057, 1489, 1022, 26, 90, "Input"],
Cell[62082, 1517, 946, 16, 38, "Output"],
Cell[63031, 1535, 1166, 23, 38, "Output"],
Cell[64200, 1560, 1171, 24, 38, "Output"],
Cell[65374, 1586, 998, 18, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[66409, 1609, 1574, 46, 124, "Input"],
Cell[67986, 1657, 1669, 39, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[69692, 1701, 703, 17, 90, "Input"],
Cell[70398, 1720, 922, 16, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71357, 1741, 365, 8, 73, "Input"],
Cell[71725, 1751, 1675, 39, 56, "Output"],
Cell[73403, 1792, 2806, 72, 90, "Output"]
}, Open  ]],
Cell[76224, 1867, 1241, 30, 107, "Input"],
Cell[CellGroupData[{
Cell[77490, 1901, 244, 4, 56, "Input"],
Cell[77737, 1907, 998, 17, 38, "Output"],
Cell[78738, 1926, 1088, 20, 38, "Output"]
}, Open  ]],
Cell[79841, 1949, 325, 7, 38, "Input"],
Cell[CellGroupData[{
Cell[80191, 1960, 1541, 36, 141, "Input"],
Cell[81735, 1998, 1199, 21, 38, "Output"],
Cell[82937, 2021, 2531, 59, 96, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[85505, 2085, 862, 21, 56, "Input"],
Cell[86370, 2108, 2115, 49, 96, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88522, 2162, 1111, 32, 107, "Input"],
Cell[89636, 2196, 1151, 20, 41, "Output"],
Cell[90790, 2218, 1149, 20, 41, "Output"],
Cell[91942, 2240, 1627, 35, 58, "Output"],
Cell[93572, 2277, 1532, 33, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95141, 2315, 1047, 20, 73, "Input"],
Cell[96191, 2337, 2200, 51, 58, "Output"]
}, Open  ]],
Cell[98406, 2391, 809, 20, 56, "Input"],
Cell[99218, 2413, 573, 14, 56, "Input"],
Cell[CellGroupData[{
Cell[99816, 2431, 2930, 82, 311, "Input"],
Cell[102749, 2515, 1628, 29, 309, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[104414, 2549, 1993, 55, 243, "Input"],
Cell[106410, 2606, 725, 17, 275, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[107172, 2628, 3723, 96, 294, "Input"],
Cell[110898, 2726, 1624, 30, 275, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)

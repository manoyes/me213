(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     41376,       1117]
NotebookOptionsPosition[     39538,       1057]
NotebookOutlinePosition[     40060,       1075]
CellTagsIndexPosition[     40017,       1072]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{"ClearAll", "[", "\"\<Global`*\>\"", "]"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"Problem", " ", "1"}], " ", "*)"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "Energies", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"T", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], " ", "m1", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"y1", "'"}], "[", "t", "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"z1", "'"}], "[", "t", "]"}], "^", "2"}]}], ")"}]}], " ", 
      "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "/", "2"}], ")"}], "m2", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"y2", "'"}], "[", "t", "]"}], "^", "2"}], "+", 
         RowBox[{
          RowBox[{
           RowBox[{"z2", "'"}], "[", "t", "]"}], "^", "2"}]}], ")"}]}]}]}], 
    " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"V", "=", 
     RowBox[{
      RowBox[{"m1", " ", "g", " ", 
       RowBox[{"z1", "[", "t", "]"}]}], " ", "+", " ", 
      RowBox[{"m2", " ", "g", " ", 
       RowBox[{"z2", "[", "t", "]"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"Geometric", " ", "contrainsts"}], " ", "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"y1", "[", "t_", "]"}], " ", "=", " ", 
     RowBox[{"l1", " ", 
      RowBox[{"Sin", "[", 
       RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"y2", "[", "t_", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"y1", "[", "t", "]"}], " ", "+", " ", 
      RowBox[{"l2", " ", 
       RowBox[{"Sin", "[", 
        RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"z1", "[", "t_", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"-", "l1"}], " ", 
      RowBox[{"Cos", "[", 
       RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"z2", "[", "t_", "]"}], " ", "=", " ", 
     RowBox[{
      RowBox[{"z1", "[", "t", "]"}], "-", 
      RowBox[{"l2", " ", 
       RowBox[{"Cos", "[", 
        RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{"E", "-", 
     RowBox[{"L", " ", "Method"}]}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{"T", "=", 
    RowBox[{"Collect", "[", 
     RowBox[{"T", ",", "\[Theta]", ",", "Simplify"}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"V", "=", 
    RowBox[{"Simplify", "[", "V", "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"L", " ", "=", " ", 
     RowBox[{"T", "-", "V"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.60480209441348*^9, 3.60480224637568*^9}, {
  3.6048053539504223`*^9, 3.604805414124034*^9}, {3.604847511925222*^9, 
  3.604847524509181*^9}, {3.604847870081482*^9, 3.6048478827970133`*^9}, {
  3.6048562737754707`*^9, 3.604856295529134*^9}, {3.604920144599045*^9, 
  3.604920155299158*^9}, {3.605975405992836*^9, 3.605975443551852*^9}, {
  3.6059754882271137`*^9, 3.605975496580023*^9}, {3.605975533651566*^9, 
  3.605975543938223*^9}, {3.605985212026949*^9, 3.6059852121480513`*^9}, {
  3.606135208214554*^9, 3.606135213891749*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      SuperscriptBox["l1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"m1", "+", "m2"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[Theta]1", "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "2"]}], "+", 
     RowBox[{"2", " ", "l1", " ", "l2", " ", "m2", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]1", "\[Prime]",
        MultilineFunction->None], "(", "t", ")"}], " ", 
      RowBox[{
       SuperscriptBox["\[Theta]2", "\[Prime]",
        MultilineFunction->None], "(", "t", ")"}], " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"\[Theta]1", "(", "t", ")"}], "-", 
        RowBox[{"\[Theta]2", "(", "t", ")"}]}], ")"}]}], "+", 
     RowBox[{
      SuperscriptBox["l2", "2"], " ", "m2", " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[Theta]2", "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "2"]}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.605975497319916*^9, 3.6059778462545967`*^9, 3.6059847479568043`*^9, {
   3.60598521474013*^9, 3.6059852542093678`*^9}, 3.606064528856214*^9, 
   3.606135091415893*^9, 3.606135164357253*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"-", "g"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"l1", " ", 
      RowBox[{"(", 
       RowBox[{"m1", "+", "m2"}], ")"}], " ", 
      RowBox[{"cos", "(", 
       RowBox[{"\[Theta]1", "(", "t", ")"}], ")"}]}], "+", 
     RowBox[{"l2", " ", "m2", " ", 
      RowBox[{"cos", "(", 
       RowBox[{"\[Theta]2", "(", "t", ")"}], ")"}]}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.605975497319916*^9, 3.6059778462545967`*^9, 3.6059847479568043`*^9, {
   3.60598521474013*^9, 3.6059852542093678`*^9}, 3.606064528856214*^9, 
   3.606135091415893*^9, 3.606135164399248*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"E", "-", 
    RowBox[{"L", " ", "equations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"eqn1", "=", 
    RowBox[{
     RowBox[{"Simplify", "[", 
      RowBox[{
       RowBox[{"D", "[", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"L", ",", 
           RowBox[{
            RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
        "]"}], "-", 
       RowBox[{"D", "[", 
        RowBox[{"L", ",", 
         RowBox[{"\[Theta]1", "[", "t", "]"}]}], "]"}]}], "]"}], "-", " ", 
     "\[Tau]"}]}], "\[IndentingNewLine]", 
   RowBox[{"eqn2", "=", 
    RowBox[{"Simplify", "[", 
     RowBox[{
      RowBox[{"D", "[", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"L", ",", 
          RowBox[{
           RowBox[{"\[Theta]2", "'"}], "[", "t", "]"}]}], "]"}], ",", "t"}], 
       "]"}], "-", 
      RowBox[{"D", "[", 
       RowBox[{"L", ",", 
        RowBox[{"\[Theta]2", "[", "t", "]"}]}], "]"}]}], "]"}]}]}]}]], "Input",\

 CellChangeTimes->{{3.604802270230612*^9, 3.604802297448539*^9}, {
  3.60597545028353*^9, 3.6059754505710278`*^9}, {3.605975549158205*^9, 
  3.6059755528168707`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"l1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "m1", " ", 
       RowBox[{"sin", "(", 
        RowBox[{"\[Theta]1", "(", "t", ")"}], ")"}]}], "+", 
      RowBox[{"g", " ", "m2", " ", 
       RowBox[{"sin", "(", 
        RowBox[{"\[Theta]1", "(", "t", ")"}], ")"}]}], "+", 
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", "m2"}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]1", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}]}], "+", 
      RowBox[{"l2", " ", "m2", " ", 
       RowBox[{
        SuperscriptBox["\[Theta]2", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], " ", 
       RowBox[{"cos", "(", 
        RowBox[{
         RowBox[{"\[Theta]1", "(", "t", ")"}], "-", 
         RowBox[{"\[Theta]2", "(", "t", ")"}]}], ")"}]}], "+", 
      RowBox[{"l2", " ", "m2", " ", 
       SuperscriptBox[
        RowBox[{
         SuperscriptBox["\[Theta]2", "\[Prime]",
          MultilineFunction->None], "(", "t", ")"}], "2"], " ", 
       RowBox[{"sin", "(", 
        RowBox[{
         RowBox[{"\[Theta]1", "(", "t", ")"}], "-", 
         RowBox[{"\[Theta]2", "(", "t", ")"}]}], ")"}]}]}], ")"}]}], "-", 
   "\[Tau]"}], TraditionalForm]], "Output",
 CellChangeTimes->{
  3.6048022981883497`*^9, 3.604805429701419*^9, 3.6048478954205*^9, 
   3.604848380604824*^9, 3.604852826941059*^9, 3.6048549557113047`*^9, 
   3.60485612495221*^9, 3.60487236046386*^9, 3.605975452142623*^9, 
   3.6059755000495853`*^9, 3.6059755531859913`*^9, 3.605975596167368*^9, 
   3.605976203666453*^9, 3.605977848170267*^9, 3.605984748066732*^9, {
   3.6059852266682796`*^9, 3.6059852544201803`*^9}, 3.606064529093338*^9, 
   3.606135091793891*^9, 3.606135164461607*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"l2", " ", "m2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"g", " ", 
      RowBox[{"sin", "(", 
       RowBox[{"\[Theta]2", "(", "t", ")"}], ")"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]1", "\[Prime]\[Prime]",
        MultilineFunction->None], "(", "t", ")"}], " ", 
      RowBox[{"cos", "(", 
       RowBox[{
        RowBox[{"\[Theta]1", "(", "t", ")"}], "-", 
        RowBox[{"\[Theta]2", "(", "t", ")"}]}], ")"}]}], "-", 
     RowBox[{"l1", " ", 
      SuperscriptBox[
       RowBox[{
        SuperscriptBox["\[Theta]1", "\[Prime]",
         MultilineFunction->None], "(", "t", ")"}], "2"], " ", 
      RowBox[{"sin", "(", 
       RowBox[{
        RowBox[{"\[Theta]1", "(", "t", ")"}], "-", 
        RowBox[{"\[Theta]2", "(", "t", ")"}]}], ")"}]}], "+", 
     RowBox[{"l2", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]2", "\[Prime]\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.6048022981883497`*^9, 3.604805429701419*^9, 3.6048478954205*^9, 
   3.604848380604824*^9, 3.604852826941059*^9, 3.6048549557113047`*^9, 
   3.60485612495221*^9, 3.60487236046386*^9, 3.605975452142623*^9, 
   3.6059755000495853`*^9, 3.6059755531859913`*^9, 3.605975596167368*^9, 
   3.605976203666453*^9, 3.605977848170267*^9, 3.605984748066732*^9, {
   3.6059852266682796`*^9, 3.6059852544201803`*^9}, 3.606064529093338*^9, 
   3.606135091793891*^9, 3.60613516449501*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"Linearize", " ", "E"}], "-", 
    RowBox[{"L", " ", "equations"}]}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"leqn1", " ", "=", " ", 
    RowBox[{"eqn1", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]1", "[", "t", "]"}], "]"}], "\[Rule]", 
        RowBox[{"\[Theta]1", "[", "t", "]"}]}], ",", 
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{
          RowBox[{"\[Theta]1", "[", "t", "]"}], "-", 
          RowBox[{"\[Theta]2", "[", "t", "]"}]}], "]"}], "->", 
        RowBox[{
         RowBox[{"\[Theta]1", "[", "t", "]"}], "-", 
         RowBox[{"\[Theta]2", "[", "t", "]"}]}]}], ",", " ", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Theta]1", "[", "t", "]"}], "-", 
          RowBox[{"\[Theta]2", "[", "t", "]"}]}], "]"}], "\[Rule]", "1"}], 
       ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]2", "'"}], "[", "t", "]"}], "^", "2"}], "\[Rule]", 
        "0"}]}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"leqn2", " ", "=", " ", 
    RowBox[{"eqn2", " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{"Sin", "[", 
         RowBox[{"\[Theta]2", "[", "t", "]"}], "]"}], "\[Rule]", 
        RowBox[{"\[Theta]2", "[", "t", "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{"Cos", "[", 
         RowBox[{
          RowBox[{"\[Theta]1", "[", "t", "]"}], "-", 
          RowBox[{"\[Theta]2", "[", "t", "]"}]}], "]"}], "\[Rule]", "1"}], 
       ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]1", "'"}], "[", "t", "]"}], "^", "2"}], "\[Rule]", 
        "0"}]}], "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.605976205935767*^9, 3.6059762273641033`*^9}, {
  3.605976336566934*^9, 3.60597649282242*^9}, {3.6061352194065247`*^9, 
  3.606135228636806*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"l1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "m1", " ", 
       RowBox[{"\[Theta]1", "(", "t", ")"}]}], "+", 
      RowBox[{"g", " ", "m2", " ", 
       RowBox[{"\[Theta]1", "(", "t", ")"}]}], "+", 
      RowBox[{"l1", " ", 
       RowBox[{"(", 
        RowBox[{"m1", "+", "m2"}], ")"}], " ", 
       RowBox[{
        SuperscriptBox["\[Theta]1", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}]}], "+", 
      RowBox[{"l2", " ", "m2", " ", 
       RowBox[{
        SuperscriptBox["\[Theta]2", "\[Prime]\[Prime]",
         MultilineFunction->None], "(", "t", ")"}]}]}], ")"}]}], "-", 
   "\[Tau]"}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.605976351428172*^9, 3.605976430129455*^9}, {
   3.605976481817132*^9, 3.605976493194154*^9}, 3.605977849868903*^9, 
   3.605984748169718*^9, {3.6059852400758657`*^9, 3.60598525453046*^9}, 
   3.6060645292183437`*^9, 3.606135091930665*^9, 3.606135164562417*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"l2", " ", "m2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"g", " ", 
      RowBox[{"\[Theta]2", "(", "t", ")"}]}], "+", 
     RowBox[{"l1", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]1", "\[Prime]\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}], "+", 
     RowBox[{"l2", " ", 
      RowBox[{
       SuperscriptBox["\[Theta]2", "\[Prime]\[Prime]",
        MultilineFunction->None], "(", "t", ")"}]}]}], ")"}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.605976351428172*^9, 3.605976430129455*^9}, {
   3.605976481817132*^9, 3.605976493194154*^9}, 3.605977849868903*^9, 
   3.605984748169718*^9, {3.6059852400758657`*^9, 3.60598525453046*^9}, 
   3.6060645292183437`*^9, 3.606135091930665*^9, 3.606135164616489*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Collect", "[", 
  RowBox[{"leqn1", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]1", "''"}], "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "''"}], "[", "t", "]"}], ",", 
     RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "t", "]"}]}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"Collect", "[", 
  RowBox[{"leqn2", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"\[Theta]1", "''"}], "[", "t", "]"}], ",", 
     RowBox[{
      RowBox[{"\[Theta]2", "''"}], "[", "t", "]"}], ",", 
     RowBox[{"\[Theta]1", "[", "t", "]"}], ",", 
     RowBox[{"\[Theta]2", "[", "t", "]"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.604805525509398*^9, 3.6048055286852818`*^9}, {
   3.604805580122101*^9, 3.604805645074325*^9}, {3.605975561707066*^9, 
   3.605975588832704*^9}, 3.605976441072281*^9, 3.6059764991501217`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{"\[Theta]1", "(", "t", ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"g", " ", "l1", " ", "m1"}], "+", 
      RowBox[{"g", " ", "l1", " ", "m2"}]}], ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["l1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"m1", "+", "m2"}], ")"}], " ", 
    RowBox[{
     SuperscriptBox["\[Theta]1", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}], "+", 
   RowBox[{"l1", " ", "l2", " ", "m2", " ", 
    RowBox[{
     SuperscriptBox["\[Theta]2", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}], "-", "\[Tau]"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.604805529330908*^9, 3.604805615218313*^9, 3.604805645702003*^9, 
   3.604847901735227*^9, 3.604848386330194*^9, 3.604852828350754*^9, 
   3.604854957165372*^9, 3.604856126402893*^9, 3.604872362000404*^9, 
   3.605975589177782*^9, {3.605976437495226*^9, 3.605976441344075*^9}, {
   3.6059764965451717`*^9, 3.60597649942304*^9}, 3.605977851732655*^9, 
   3.605984748271934*^9, {3.6059852402870407`*^9, 3.605985254575759*^9}, 
   3.606064529360861*^9, 3.606135092050145*^9, 3.606135164673172*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"g", " ", "l2", " ", "m2", " ", 
    RowBox[{"\[Theta]2", "(", "t", ")"}]}], "+", 
   RowBox[{"l1", " ", "l2", " ", "m2", " ", 
    RowBox[{
     SuperscriptBox["\[Theta]1", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}], "+", 
   RowBox[{
    SuperscriptBox["l2", "2"], " ", "m2", " ", 
    RowBox[{
     SuperscriptBox["\[Theta]2", "\[Prime]\[Prime]",
      MultilineFunction->None], "(", "t", ")"}]}]}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.604805529330908*^9, 3.604805615218313*^9, 3.604805645702003*^9, 
   3.604847901735227*^9, 3.604848386330194*^9, 3.604852828350754*^9, 
   3.604854957165372*^9, 3.604856126402893*^9, 3.604872362000404*^9, 
   3.605975589177782*^9, {3.605976437495226*^9, 3.605976441344075*^9}, {
   3.6059764965451717`*^9, 3.60597649942304*^9}, 3.605977851732655*^9, 
   3.605984748271934*^9, {3.6059852402870407`*^9, 3.605985254575759*^9}, 
   3.606064529360861*^9, 3.606135092050145*^9, 3.6061351647298813`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
   "Solve", " ", "for", " ", "state", " ", "space", " ", "equations"}], " ", 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"sol", " ", "=", " ", 
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"leqn1", "\[Equal]", "0"}], ",", 
         RowBox[{"leqn2", "\[Equal]", "0"}]}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{
          RowBox[{"\[Theta]1", "''"}], "[", "t", "]"}], ",", 
         RowBox[{
          RowBox[{"\[Theta]2", "''"}], "[", "t", "]"}]}], "}"}]}], "]"}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{"p1", " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"sol", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "1"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]1", "[", "t", "]"}], ",", " ", 
        RowBox[{"\[Theta]2", "[", "t", "]"}], ",", 
        RowBox[{"\[Theta]3", "[", "t", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"p2", " ", "=", " ", 
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"sol", "[", 
       RowBox[{"[", 
        RowBox[{"1", ",", "2"}], "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"\[Theta]1", "[", "t", "]"}], ",", " ", 
        RowBox[{"\[Theta]2", "[", "t", "]"}], ",", 
        RowBox[{"\[Theta]3", "[", "t", "]"}]}], "}"}]}], "]"}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"a21", " ", "=", " ", 
    RowBox[{
     RowBox[{"p1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "/.", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", "1"}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"a22", " ", "=", " ", 
    RowBox[{
     RowBox[{"p1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], "/.", "  ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", "1"}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"a31", " ", "=", " ", 
    RowBox[{
     RowBox[{"p2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "2"}], "]"}], "]"}], " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]1", "[", "t", "]"}], "\[Rule]", "1"}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"a32", " ", "=", " ", 
    RowBox[{
     RowBox[{"p2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "3"}], "]"}], "]"}], " ", "/.", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"\[Theta]2", "[", "t", "]"}], "\[Rule]", "1"}], "}"}]}]}], 
   "\[IndentingNewLine]", 
   RowBox[{"b2", " ", "=", " ", 
    RowBox[{
     RowBox[{"p1", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "/.", 
     RowBox[{"{", 
      RowBox[{"\[Tau]", "\[Rule]", "1"}], "}"}]}]}], "\[IndentingNewLine]", 
   RowBox[{"b3", " ", "=", " ", 
    RowBox[{
     RowBox[{"p2", "[", 
      RowBox[{"[", 
       RowBox[{"2", ",", "1"}], "]"}], "]"}], " ", "/.", 
     RowBox[{"{", 
      RowBox[{"\[Tau]", "\[Rule]", "1"}], "}"}]}]}]}]}]], "Input",
 CellChangeTimes->{{3.6048034368818703`*^9, 3.604803472525948*^9}, {
   3.604805709726656*^9, 3.604806071984168*^9}, {3.604920167972171*^9, 
   3.6049201758737173`*^9}, {3.605976509572876*^9, 3.605976555035275*^9}, 
   3.605976609412343*^9, {3.6059766494966373`*^9, 3.605976834508479*^9}, {
   3.6059768652113247`*^9, 3.605976891179995*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Theta]1", "\[Prime]\[Prime]",
     MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"\[Theta]1", "(", "t", ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"g", " ", "l1", " ", "m1"}], "+", 
         RowBox[{"g", " ", "l1", " ", "m2"}]}], ")"}]}], 
      RowBox[{
       SuperscriptBox["l1", "2"], " ", "m1"}]]}], "+", 
    FractionBox[
     RowBox[{"g", " ", "m2", " ", 
      RowBox[{"\[Theta]2", "(", "t", ")"}]}], 
     RowBox[{"l1", " ", "m1"}]], "+", 
    FractionBox["\[Tau]", 
     RowBox[{
      SuperscriptBox["l1", "2"], " ", "m1"}]]}]}], TraditionalForm]], "Output",\

 CellChangeTimes->{{3.604805762996105*^9, 3.604805830138054*^9}, {
   3.604805880091387*^9, 3.604805928305628*^9}, {3.604806024893059*^9, 
   3.6048060681212463`*^9}, 3.604847903922559*^9, 3.604848388515169*^9, 
   3.604852828473172*^9, 3.604854957303831*^9, 3.6048561265330772`*^9, 
   3.604872362108632*^9, {3.605976515399548*^9, 3.605976542749303*^9}, {
   3.605976660572131*^9, 3.605976680769568*^9}, {3.605976722748612*^9, 
   3.605976728611363*^9}, {3.605976764544854*^9, 3.605976818164733*^9}, {
   3.605976881619953*^9, 3.605976891673221*^9}, 3.60597785322609*^9, 
   3.605984748324136*^9, {3.605985241075715*^9, 3.6059852612510653`*^9}, 
   3.606064529459484*^9, 3.60613509216223*^9, 3.606135164795948*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SuperscriptBox["\[Theta]2", "\[Prime]\[Prime]",
     MultilineFunction->None], "(", "t", ")"}], "\[Rule]", 
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"\[Theta]1", "(", "t", ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          RowBox[{"g", " ", "l1", " ", "m1"}]}], "-", 
         RowBox[{"g", " ", "l1", " ", "m2"}]}], ")"}]}], 
      RowBox[{"l1", " ", "l2", " ", "m1"}]]}], "-", 
    FractionBox[
     RowBox[{
      RowBox[{"\[Theta]2", "(", "t", ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"g", " ", "l1", " ", "m1"}], "+", 
        RowBox[{"g", " ", "l1", " ", "m2"}]}], ")"}]}], 
     RowBox[{"l1", " ", "l2", " ", "m1"}]], "-", 
    FractionBox["\[Tau]", 
     RowBox[{"l1", " ", "l2", " ", "m1"}]]}]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.604805762996105*^9, 3.604805830138054*^9}, {
   3.604805880091387*^9, 3.604805928305628*^9}, {3.604806024893059*^9, 
   3.6048060681212463`*^9}, 3.604847903922559*^9, 3.604848388515169*^9, 
   3.604852828473172*^9, 3.604854957303831*^9, 3.6048561265330772`*^9, 
   3.604872362108632*^9, {3.605976515399548*^9, 3.605976542749303*^9}, {
   3.605976660572131*^9, 3.605976680769568*^9}, {3.605976722748612*^9, 
   3.605976728611363*^9}, {3.605976764544854*^9, 3.605976818164733*^9}, {
   3.605976881619953*^9, 3.605976891673221*^9}, 3.60597785322609*^9, 
   3.605984748324136*^9, {3.605985241075715*^9, 3.6059852612510653`*^9}, 
   3.606064529459484*^9, 3.60613509216223*^9, 3.60613516480066*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"g", " ", "l1", " ", "m1"}], "+", 
     RowBox[{"g", " ", "l1", " ", "m2"}]}], 
    RowBox[{
     SuperscriptBox["l1", "2"], " ", "m1"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.604805762996105*^9, 3.604805830138054*^9}, {
   3.604805880091387*^9, 3.604805928305628*^9}, {3.604806024893059*^9, 
   3.6048060681212463`*^9}, 3.604847903922559*^9, 3.604848388515169*^9, 
   3.604852828473172*^9, 3.604854957303831*^9, 3.6048561265330772`*^9, 
   3.604872362108632*^9, {3.605976515399548*^9, 3.605976542749303*^9}, {
   3.605976660572131*^9, 3.605976680769568*^9}, {3.605976722748612*^9, 
   3.605976728611363*^9}, {3.605976764544854*^9, 3.605976818164733*^9}, {
   3.605976881619953*^9, 3.605976891673221*^9}, 3.60597785322609*^9, 
   3.605984748324136*^9, {3.605985241075715*^9, 3.6059852612510653`*^9}, 
   3.606064529459484*^9, 3.60613509216223*^9, 3.606135164859599*^9}],

Cell[BoxData[
 FormBox[
  FractionBox[
   RowBox[{"g", " ", "m2"}], 
   RowBox[{"l1", " ", "m1"}]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.604805762996105*^9, 3.604805830138054*^9}, {
   3.604805880091387*^9, 3.604805928305628*^9}, {3.604806024893059*^9, 
   3.6048060681212463`*^9}, 3.604847903922559*^9, 3.604848388515169*^9, 
   3.604852828473172*^9, 3.604854957303831*^9, 3.6048561265330772`*^9, 
   3.604872362108632*^9, {3.605976515399548*^9, 3.605976542749303*^9}, {
   3.605976660572131*^9, 3.605976680769568*^9}, {3.605976722748612*^9, 
   3.605976728611363*^9}, {3.605976764544854*^9, 3.605976818164733*^9}, {
   3.605976881619953*^9, 3.605976891673221*^9}, 3.60597785322609*^9, 
   3.605984748324136*^9, {3.605985241075715*^9, 3.6059852612510653`*^9}, 
   3.606064529459484*^9, 3.60613509216223*^9, 3.606135164861912*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"-", 
      RowBox[{"g", " ", "l1", " ", "m1"}]}], "-", 
     RowBox[{"g", " ", "l1", " ", "m2"}]}], 
    RowBox[{"l1", " ", "l2", " ", "m1"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.604805762996105*^9, 3.604805830138054*^9}, {
   3.604805880091387*^9, 3.604805928305628*^9}, {3.604806024893059*^9, 
   3.6048060681212463`*^9}, 3.604847903922559*^9, 3.604848388515169*^9, 
   3.604852828473172*^9, 3.604854957303831*^9, 3.6048561265330772`*^9, 
   3.604872362108632*^9, {3.605976515399548*^9, 3.605976542749303*^9}, {
   3.605976660572131*^9, 3.605976680769568*^9}, {3.605976722748612*^9, 
   3.605976728611363*^9}, {3.605976764544854*^9, 3.605976818164733*^9}, {
   3.605976881619953*^9, 3.605976891673221*^9}, 3.60597785322609*^9, 
   3.605984748324136*^9, {3.605985241075715*^9, 3.6059852612510653`*^9}, 
   3.606064529459484*^9, 3.60613509216223*^9, 3.606135164866291*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"g", " ", "l1", " ", "m1"}], "+", 
     RowBox[{"g", " ", "l1", " ", "m2"}]}], 
    RowBox[{"l1", " ", "l2", " ", "m1"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.604805762996105*^9, 3.604805830138054*^9}, {
   3.604805880091387*^9, 3.604805928305628*^9}, {3.604806024893059*^9, 
   3.6048060681212463`*^9}, 3.604847903922559*^9, 3.604848388515169*^9, 
   3.604852828473172*^9, 3.604854957303831*^9, 3.6048561265330772`*^9, 
   3.604872362108632*^9, {3.605976515399548*^9, 3.605976542749303*^9}, {
   3.605976660572131*^9, 3.605976680769568*^9}, {3.605976722748612*^9, 
   3.605976728611363*^9}, {3.605976764544854*^9, 3.605976818164733*^9}, {
   3.605976881619953*^9, 3.605976891673221*^9}, 3.60597785322609*^9, 
   3.605984748324136*^9, {3.605985241075715*^9, 3.6059852612510653`*^9}, 
   3.606064529459484*^9, 3.60613509216223*^9, 3.606135164907877*^9}],

Cell[BoxData[
 FormBox[
  FractionBox["1", 
   RowBox[{
    SuperscriptBox["l1", "2"], " ", "m1"}]], TraditionalForm]], "Output",
 CellChangeTimes->{{3.604805762996105*^9, 3.604805830138054*^9}, {
   3.604805880091387*^9, 3.604805928305628*^9}, {3.604806024893059*^9, 
   3.6048060681212463`*^9}, 3.604847903922559*^9, 3.604848388515169*^9, 
   3.604852828473172*^9, 3.604854957303831*^9, 3.6048561265330772`*^9, 
   3.604872362108632*^9, {3.605976515399548*^9, 3.605976542749303*^9}, {
   3.605976660572131*^9, 3.605976680769568*^9}, {3.605976722748612*^9, 
   3.605976728611363*^9}, {3.605976764544854*^9, 3.605976818164733*^9}, {
   3.605976881619953*^9, 3.605976891673221*^9}, 3.60597785322609*^9, 
   3.605984748324136*^9, {3.605985241075715*^9, 3.6059852612510653`*^9}, 
   3.606064529459484*^9, 3.60613509216223*^9, 3.606135164910495*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"-", 
   FractionBox["1", 
    RowBox[{"l1", " ", "l2", " ", "m1"}]]}], TraditionalForm]], "Output",
 CellChangeTimes->{{3.604805762996105*^9, 3.604805830138054*^9}, {
   3.604805880091387*^9, 3.604805928305628*^9}, {3.604806024893059*^9, 
   3.6048060681212463`*^9}, 3.604847903922559*^9, 3.604848388515169*^9, 
   3.604852828473172*^9, 3.604854957303831*^9, 3.6048561265330772`*^9, 
   3.604872362108632*^9, {3.605976515399548*^9, 3.605976542749303*^9}, {
   3.605976660572131*^9, 3.605976680769568*^9}, {3.605976722748612*^9, 
   3.605976728611363*^9}, {3.605976764544854*^9, 3.605976818164733*^9}, {
   3.605976881619953*^9, 3.605976891673221*^9}, 3.60597785322609*^9, 
   3.605984748324136*^9, {3.605985241075715*^9, 3.6059852612510653`*^9}, 
   3.606064529459484*^9, 3.60613509216223*^9, 3.60613516491276*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"State", " ", "space", " ", "matrix"}], " ", "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"A", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"a21", ",", "a22", ",", "0", ",", "0"}], "}"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"a31", ",", "a32", ",", "0", ",", "0"}], "}"}]}], "}"}]}], " ",
    "\[IndentingNewLine]", 
   RowBox[{"B", " ", "=", " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "0", "}"}], ",", 
      RowBox[{"{", "b2", "}"}], ",", 
      RowBox[{"{", "b3", "}"}]}], "}"}]}]}]}]], "Input",
 CellChangeTimes->{{3.604803483042338*^9, 3.604803486964986*^9}, {
   3.604805660697*^9, 3.60480569772714*^9}, {3.604806077448135*^9, 
   3.604806101606605*^9}, {3.604920179980824*^9, 3.6049201861314707`*^9}, {
   3.605976575135672*^9, 3.605976641666122*^9}, {3.605976850671426*^9, 
   3.605976852797145*^9}, {3.605976896469544*^9, 3.6059769065851717`*^9}, {
   3.60597702126826*^9, 3.6059770342254333`*^9}, {3.60598472980851*^9, 
   3.6059847723234*^9}, {3.6060645222654457`*^9, 3.606064536949163*^9}, {
   3.606064610460956*^9, 3.6060646138944197`*^9}, 3.606064657207438*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "1", "0"},
     {"0", "0", "0", "1"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"g", " ", "l1", " ", "m1"}], "+", 
         RowBox[{"g", " ", "l1", " ", "m2"}]}], 
        RowBox[{
         SuperscriptBox["l1", "2"], " ", "m1"}]]}], 
      FractionBox[
       RowBox[{"g", " ", "m2"}], 
       RowBox[{"l1", " ", "m1"}]], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", "l1", " ", "m1"}], "-", 
         RowBox[{"g", " ", "l1", " ", "m2"}]}], 
        RowBox[{"l1", " ", "l2", " ", "m1"}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"g", " ", "l1", " ", "m1"}], "+", 
         RowBox[{"g", " ", "l1", " ", "m2"}]}], 
        RowBox[{"l1", " ", "l2", " ", "m1"}]]}], "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.604805685560153*^9, {3.604806097490699*^9, 3.604806102456605*^9}, 
   3.604847906576515*^9, 3.604848391116088*^9, 3.604852828621973*^9, 
   3.6048549574821243`*^9, 3.604856126713599*^9, 3.604872362338916*^9, 
   3.605976599172155*^9, 3.605976645949355*^9, 3.6059768377606277`*^9, 
   3.605976907200419*^9, {3.605977027765252*^9, 3.605977034797621*^9}, 
   3.6059778626049337`*^9, {3.6059847429024763`*^9, 3.6059847731763563`*^9}, {
   3.605985254737712*^9, 3.605985266425252*^9}, {3.606064523393053*^9, 
   3.606064537643531*^9}, 3.606064614432584*^9, 3.6060647602280903`*^9, 
   3.606135092591061*^9, 3.6061351649736967`*^9}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0"},
     {"0"},
     {
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", "m1"}]]},
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"l1", " ", "l2", " ", "m1"}]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{
  3.604805685560153*^9, {3.604806097490699*^9, 3.604806102456605*^9}, 
   3.604847906576515*^9, 3.604848391116088*^9, 3.604852828621973*^9, 
   3.6048549574821243`*^9, 3.604856126713599*^9, 3.604872362338916*^9, 
   3.605976599172155*^9, 3.605976645949355*^9, 3.6059768377606277`*^9, 
   3.605976907200419*^9, {3.605977027765252*^9, 3.605977034797621*^9}, 
   3.6059778626049337`*^9, {3.6059847429024763`*^9, 3.6059847731763563`*^9}, {
   3.605985254737712*^9, 3.605985266425252*^9}, {3.606064523393053*^9, 
   3.606064537643531*^9}, 3.606064614432584*^9, 3.6060647602280903`*^9, 
   3.606135092591061*^9, 3.606135164977467*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Q", " ", "=", " ", 
  RowBox[{"Transpose", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Flatten", "[", "B", "]"}], ",", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"A", ".", "B"}], "]"}], ",", " ", 
     RowBox[{"Flatten", "[", 
      RowBox[{"A", ".", "A", ".", "B"}], "]"}], ",", 
     RowBox[{"Flatten", "[", 
      RowBox[{"A", ".", "A", ".", "A", ".", "B"}], "]"}]}], "}"}], " ", 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.605976910070673*^9, 3.6059769359948683`*^9}, {
  3.6059770079538717`*^9, 3.605977014783869*^9}, {3.6059773160653543`*^9, 
  3.605977318433234*^9}, {3.605977870183344*^9, 3.605977871546959*^9}, {
  3.606135065001671*^9, 3.6061350877644033`*^9}}],

Cell[BoxData[
 FormBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", 
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", "m1"}]], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"g", " ", "m2"}], 
         RowBox[{
          SuperscriptBox["l1", "2"], " ", "l2", " ", 
          SuperscriptBox["m1", "2"]}]]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"g", " ", "l1", " ", "m1"}], "+", 
         RowBox[{"g", " ", "l1", " ", "m2"}]}], 
        RowBox[{
         SuperscriptBox["l1", "4"], " ", 
         SuperscriptBox["m1", "2"]}]]}]},
     {"0", 
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"l1", " ", "l2", " ", "m1"}]]}], "0", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"g", " ", "l1", " ", "m1"}], "+", 
         RowBox[{"g", " ", "l1", " ", "m2"}]}], 
        RowBox[{
         SuperscriptBox["l1", "2"], " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["m1", "2"]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", "l1", " ", "m1"}], "-", 
         RowBox[{"g", " ", "l1", " ", "m2"}]}], 
        RowBox[{
         SuperscriptBox["l1", "3"], " ", "l2", " ", 
         SuperscriptBox["m1", "2"]}]]}]},
     {
      FractionBox["1", 
       RowBox[{
        SuperscriptBox["l1", "2"], " ", "m1"}]], "0", 
      RowBox[{
       RowBox[{"-", 
        FractionBox[
         RowBox[{"g", " ", "m2"}], 
         RowBox[{
          SuperscriptBox["l1", "2"], " ", "l2", " ", 
          SuperscriptBox["m1", "2"]}]]}], "-", 
       FractionBox[
        RowBox[{
         RowBox[{"g", " ", "l1", " ", "m1"}], "+", 
         RowBox[{"g", " ", "l1", " ", "m2"}]}], 
        RowBox[{
         SuperscriptBox["l1", "4"], " ", 
         SuperscriptBox["m1", "2"]}]]}], "0"},
     {
      RowBox[{"-", 
       FractionBox["1", 
        RowBox[{"l1", " ", "l2", " ", "m1"}]]}], "0", 
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"g", " ", "l1", " ", "m1"}], "+", 
         RowBox[{"g", " ", "l1", " ", "m2"}]}], 
        RowBox[{
         SuperscriptBox["l1", "2"], " ", 
         SuperscriptBox["l2", "2"], " ", 
         SuperscriptBox["m1", "2"]}]], "-", 
       FractionBox[
        RowBox[{
         RowBox[{
          RowBox[{"-", "g"}], " ", "l1", " ", "m1"}], "-", 
         RowBox[{"g", " ", "l1", " ", "m2"}]}], 
        RowBox[{
         SuperscriptBox["l1", "3"], " ", "l2", " ", 
         SuperscriptBox["m1", "2"]}]]}], "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}], 
  TraditionalForm]], "Output",
 CellChangeTimes->{{3.6059770052795143`*^9, 3.605977041712152*^9}, 
   3.6059773193068743`*^9, {3.605977840470057*^9, 3.6059778722329817`*^9}, 
   3.605984748479261*^9, {3.605985254786779*^9, 3.605985283051135*^9}, 
   3.60606452962255*^9, 3.606135092637748*^9, 3.606135165039302*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"Answer", ":", " ", 
      RowBox[{"Matrix", " ", "Rank", " ", "of", " ", "Q"}]}], " ", "=", " ", 
     "N"}], ",", " ", 
    RowBox[{
    "so", " ", "the", " ", "system", " ", "is", " ", "controllable"}]}], 
   "*)"}], "\[IndentingNewLine]", 
  RowBox[{"MatrixRank", "[", "Q", "]"}]}]], "Input",
 CellChangeTimes->{{3.605978044776095*^9, 3.605978089354352*^9}, {
  3.60613517035067*^9, 3.606135172731217*^9}}],

Cell[BoxData[
 FormBox["4", TraditionalForm]], "Output",
 CellChangeTimes->{
  3.605978048001526*^9, 3.605984748988936*^9, 3.60598525522859*^9, {
   3.605985290910235*^9, 3.605985296321424*^9}, 3.606064530244828*^9, 
   3.606135092931645*^9, 3.606135165081934*^9}]
}, Open  ]]
},
WindowSize->{640, 752},
WindowMargins->{{Automatic, 0}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->FrontEnd`FileName[{$RootDirectory, "Applications", 
   "Mathematica.app", "SystemFiles", "FrontEnd", "StyleSheets", "Creative"}, 
  "NaturalColor.nb", CharacterEncoding -> "UTF-8"]
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[557, 20, 76, 1, 38, "Input"],
Cell[CellGroupData[{
Cell[658, 25, 3498, 97, 328, "Input"],
Cell[4159, 124, 1288, 35, 58, "Output"],
Cell[5450, 161, 646, 18, 38, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6133, 184, 1212, 37, 73, "Input"],
Cell[7348, 223, 1800, 43, 68, "Output"],
Cell[9151, 268, 1527, 37, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[10715, 310, 1992, 55, 124, "Input"],
Cell[12710, 367, 1001, 24, 45, "Output"],
Cell[13714, 393, 790, 19, 45, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[14541, 417, 936, 24, 56, "Input"],
Cell[15480, 443, 1199, 28, 43, "Output"],
Cell[16682, 473, 1027, 22, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17746, 500, 3472, 100, 192, "Input"],
Cell[21221, 602, 1468, 34, 59, "Output"],
Cell[22692, 638, 1593, 36, 58, "Output"],
Cell[24288, 676, 967, 18, 59, "Output"],
Cell[25258, 696, 844, 14, 58, "Output"],
Cell[26105, 712, 973, 18, 58, "Output"],
Cell[27081, 732, 951, 17, 58, "Output"],
Cell[28035, 751, 845, 14, 59, "Output"],
Cell[28883, 767, 849, 14, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[29769, 786, 1493, 35, 124, "Input"],
Cell[31265, 823, 2018, 51, 112, "Output"],
Cell[33286, 876, 1392, 34, 112, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[34715, 915, 709, 16, 56, "Input"],
Cell[35427, 933, 3297, 96, 134, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38761, 1034, 494, 13, 73, "Input"],
Cell[39258, 1049, 264, 5, 38, "Output"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
